var SimpleLocator,active_form="",formatted_address="",googlemaps_response="";function openInfoWindow(o){google.maps.event.trigger(SimpleLocator.markers[0][o],"click");var e=SimpleLocator.markers[0][o].getPosition().lat(),t=SimpleLocator.markers[0][o].getPosition().lng(),a=new google.maps.LatLng(e,t);return SimpleLocator.maps[0].panTo(a),SimpleLocator.maps[0].fitBounds(a),SimpleLocator.maps[0].setZoom(12),!1}function wpsl_before_submit(o,e){}function wpsl_after_render(o){}function wpsl_click_marker(o,e,t,a){}function wpsl_no_results(o,e){}function wpsl_error(o,e){}function wpsl_success(o,e,t){}function wpsl_googlemaps_response(){return googlemaps_response}function wpsl_all_locations_rendered(o){}function wpsl_all_locations_marker_clicked(o,e){}function wpsl_googlemaps_response(){return googlemaps_response}(SimpleLocator=SimpleLocator||{}).SingleLocation=function(){var o=this,e=jQuery;return o.selectors={mapContainer:"data-simple-locator-single-map",latitude:"data-latitude",longitude:"data-longitude",title:"data-title"},o.bindEvents=function(){e(document).ready(function(){o.loadAllMaps()})},o.loadAllMaps=function(){var t=e("["+o.selectors.mapContainer+"]");e.each(t,function(){o.loadMap(e(this))})},o.loadMap=function(t){var a=parseFloat(e(t).attr(o.selectors.latitude)),r=parseFloat(e(t).attr(o.selectors.longitude)),i=e(t).attr(o.selectors.title),n=wpsl_locator.mappin?wpsl_locator.mappin:"",s=new google.maps.LatLng(a,r),l={zoom:12,styles:wpsl_locator.mapstyles};"1"===wpsl_locator.custom_map_options&&(l=wpsl_locator.map_options),l.center=s;var c=new google.maps.Map(t[0],l);new google.maps.Marker({position:s,map:c,icon:n,title:i});e(t).removeClass("loading")},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).Form=function(){var o=this,e=jQuery;return o.activeForm,o.activeFormContainer,o.isWidget=!1,o.mapContainer,o.resultsContainer,o.formData,o.isAjax=!1,o.page=1,o.formIndex,o.bindEvents=function(){e(document).on("click","["+SimpleLocator.selectors.submitButton+"]",function(t){t.preventDefault(),o.activeForm=e(this).parents("["+SimpleLocator.selectors.form+"]"),o.activeFormContainer=e(this).parents("["+SimpleLocator.selectors.formContainer+"]"),e(o.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),o.setAjax(),active_form=o.activeForm,wpsl_before_submit(o.activeForm),e(document).trigger("simple-locator-before-submit",[o.activeForm]),o.processForm()}),e(document).on("simple-locator-geolocation-success",function(t,a,r){o.activeForm=e(a),o.activeFormContainer=e(a).parents("["+SimpleLocator.selectors.formContainer+"]"),e(o.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(r.latitude),e(o.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(r.longitude),e(o.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val("1"),o.setAjax(),wpsl_before_submit(o.activeForm),e(document).trigger("simple-locator-before-submit",[o.activeForm]),o.setResultsContainers(),o.setFormData(),o.submitForm()}),e(document).on("simple-locator-address-geocoded",function(t,a,r){o.toggleLoading(!0,!0),e(o.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),e(o.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(a.latitude),e(o.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(a.longitude),e(o.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(a.formatted_address),o.setFormData(),o.submitForm()}),e(document).on("click","["+SimpleLocator.selectors.paginationButton+"]",function(t){o.activeForm&&(e(o.activeFormContainer).hasClass("has-geolocation")&&!o.isAjax||(t.preventDefault(),e(o.activeFormContainer).addClass("loading"),o.paginate(e(this))))}),e(document).on("simple-locator-autocomplete-changed",function(t,a,r){o.activeForm=e(r),o.activeFormContainer=e(r).parents("["+SimpleLocator.selectors.formContainer+"]"),o.setAjax(),o.toggleLoading(!0,!0),e(o.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),e(o.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(a.geometry.location.lat()),e(o.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(a.geometry.location.lng()),e(o.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(a.formatted_address),o.page>1&&(o.page=1),o.setFormData(),o.submitForm()}),e(document).on("submit","["+SimpleLocator.selectors.pageJumpForm+"]",function(t){var a=e(this).parents("["+SimpleLocator.selectors.resultsWrapper+"]");e(a).hasClass("non-ajax")||(t.preventDefault(),o.jumpToPage(e(this)))})},o.setAjax=function(){var t=e(o.activeForm).attr(SimpleLocator.selectors.ajaxForm);o.isAjax=void 0!==t&&"true"===t},o.processForm=function(e){o.toggleLoading(!0,!0),o.setResultsContainers(),(new SimpleLocator.Geocoder).getCoordinates(o.activeForm)},o.setResultsContainers=function(){e(o.activeForm).siblings("#widget").length>0&&(o.isWidget=!0),"undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options||(wpsl_locator_options=""),o.mapContainer=""===wpsl_locator_options.mapcont||o.isWidget?e(o.activeFormContainer).find("["+SimpleLocator.selectors.map+"]"):e(wpsl_locator_options.mapcont),o.resultsContainer=""===wpsl_locator_options.resultscontainer||o.isWidget?o.activeFormContainer.find("["+SimpleLocator.selectors.results+"]"):e(wpsl_locator_options.resultscontainer)},o.setFormData=function(){var t=e(o.activeForm).attr("data-simple-locator-form-allow-empty");t=void 0!==t&&""!==t;var a=e(o.activeForm).find("["+SimpleLocator.selectors.inputAddress+"]");a=void 0!==a&&e(a).val();var r=e(o.activeForm).find("["+SimpleLocator.selectors.inputDistance+"]");r=void 0!==r&&e(r).val();var i=e(o.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val();i=""!==i&&"false"!==i;var n=e(o.activeForm).find("["+SimpleLocator.selectors.inputLimit+"]").val();if(n=""===n?null:n,o.formData={address:a,formatted_address:e(o.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(),distance:r,latitude:e(o.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(),longitude:e(o.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(),unit:e(o.activeForm).find("["+SimpleLocator.selectors.inputUnit+"]").val(),geolocation:i,allow_empty_address:t,ajax:o.isAjax,per_page:n,page:o.page},o.setTaxonomies(),0!=wpsl_locator.postfields.length)for(var s=0;s<wpsl_locator.postfields.length;s++){var l=wpsl_locator.postfields[s];o.formData[l]=e("input[name="+l+"]").val()}},o.setTaxonomies=function(){var t=e(o.activeForm).find("[data-simple-locator-taxonomy-checkbox]:checked"),a=e(o.activeForm).find("[data-simple-locator-taxonomy-select]"),r={};e.each(a,function(o,t){""!==e(this).val()&&(r[e(this).attr("data-simple-locator-taxonomy-select")]=[e(this).val()])}),e.each(t,function(o,t){var a=e(this).attr("data-simple-locator-taxonomy-checkbox");r[a]instanceof Array||(r[a]=[]),r[a].push(parseInt(e(this).val()))}),o.formData.taxfilter=r},o.setAutoload=function(){var t=e(o.activeFormContainer).hasClass("has-geolocation");o.formData.autoload=t,o.formData.formmethod=e(o.activeForm).attr("method"),o.formData.resultspage=e(o.activeForm).find('input[name="results_page"]').val(),o.formData.mapheight=e(o.activeForm).find('input[name="mapheight"]').val(),o.formData.search_page=e(o.activeForm).find('input[name="search_page"]').val()},o.setFormIndex=function(){var t=e("["+SimpleLocator.selectors.form+"]");o.formIndex=e(o.activeForm).index(t)},o.submitForm=function(){o.setFormIndex(),o.setAutoload(),o.formData.ajax||o.formData.autoload?(o.formData.page=o.page,e.ajax({url:SimpleLocator.endpoints.search,type:"GET",datatype:"jsonp",data:o.formData,beforeSend:function(e,t){"1"===wpsl_locator.jsdebug&&(console.log("Form Data"),console.log(o.formData),console.log("URL"),console.log(t.url))},success:function(t){if(SimpleLocator.formData[o.formIndex]=t,SimpleLocator.formData[o.formIndex].allLocations=!1,"1"===wpsl_locator.jsdebug&&(console.log("Form Response"),console.log(t)),"error"===t.status)return e(document).trigger("simple-locator-error",[o.activeForm,t.message]),void o.toggleLoading(!1,!0);if(0===t.result_count){var a=wpsl_locator.nolocationserror+" "+t.formatted_address;return e(document).trigger("simple-locator-error",[o.activeForm,a]),wpsl_no_results(o.formData.formatted_address,o.activeForm),void o.toggleLoading(!1,!0)}e(document).trigger("simple-locator-form-success",[t,o.activeForm]),wpsl_success(t.result_count,t.results,o.activeForm)},error:function(o){"1"===wpsl_locator.jsdebug&&(console.log("Form Response Error"),console.log(o.responseText))}})):e(o.activeForm).submit()},o.paginate=function(t){var a=e(t).parents("["+SimpleLocator.selectors.formContainer+"]"),r=e(a).index("["+SimpleLocator.selectors.formContainer+"]");if(!SimpleLocator.formData[r].allLocations){if("next"===e(t).attr(SimpleLocator.selectors.paginationButton))return o.page=o.page+1,void o.submitForm();o.page=o.page-1,o.submitForm()}},o.jumpToPage=function(t){var a=parseInt(e(t).find('input[type="tel"]').val());if(!isNaN(a)){o.activeFormContainer=e(t).parents("["+SimpleLocator.selectors.formContainer+"]"),o.activeForm=e(o.activeFormContainer).find("["+SimpleLocator.selectors.form+"]"),o.formIndex=e(o.activeFormContainer).index("["+SimpleLocator.selectors.formContainer+"]");var r=SimpleLocator.formData[o.formIndex].total_pages;void 0!==r&&a>r||void 0!==SimpleLocator.formData[o.formIndex]&&""!==SimpleLocator.formData[o.formIndex]&&(SimpleLocator.formData[o.formIndex].allLocations||(e(o.activeFormContainer).addClass("loading"),o.page=a,o.submitForm()))}},o.toggleLoading=function(t,a){var r=e(o.activeFormContainer).find("["+SimpleLocator.selectors.results+"]");if(t)return a&&(e("["+SimpleLocator.selectors.inputLatitude+"]").val(""),e("["+SimpleLocator.selectors.inputLongitude+"]").val(""),e("["+SimpleLocator.selectors.inputGeocode+"]").val(""),e("["+SimpleLocator.selectors.inputFormattedLocation+"]").val("")),e(o.activeFormContainer).addClass("loading"),e(o.activeFormContainer).find("["+SimpleLocator.selectors.formError+"]").hide(),void e(r).empty();e(o.activeFormContainer).removeClass("loading")},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).Geocoder=function(){var o=this,e=jQuery;o.form,o.searchTerm,o.results=[],o.getCoordinates=function(t){o.form=t,o.searchTerm=e(o.form).find("["+SimpleLocator.selectors.inputAddress+"]").val();var a=e(o.form).attr("data-simple-locator-form-allow-empty");void 0===a||"true"!=a||void 0!==o.searchTerm&&""!=o.searchTerm?"google"===SimpleLocator.mapservice&&o.queryGoogleMaps():e(document).trigger("simple-locator-address-geocoded",[o.results,o.form])},o.queryGoogleMaps=function(){geocoder=new google.maps.Geocoder,geocoder.geocode({address:o.searchTerm},function(t,a){a==google.maps.GeocoderStatus.OK?(googlemaps_response=t,o.results.latitude=t[0].geometry.location.lat(),o.results.longitude=t[0].geometry.location.lng(),o.results.formatted_address=t[0].formatted_address,"1"===wpsl_locator.jsdebug&&(console.log("Google Geocode Response"),console.log(o.results)),e(document).trigger("simple-locator-address-geocoded",[o.results,o.form])):(e(document).trigger("simple-locator-error",[o.form,wpsl_locator.notfounderror]),o.removeLoading())})},o.removeLoading=function(){e(o.form).parents("["+SimpleLocator.selectors.formContainer+"]").removeClass("loading")}},(SimpleLocator=SimpleLocator||{}).ResultsMapNonAjax=function(){var o=this,e=jQuery;return o.activeMap,o.activeWrapper,o.mapIndex,o.selectors={latitude:"data-latitude",longitude:"data-longitude"},o.bindEvents=function(){e(document).ready(function(){o.activeMap=e("["+SimpleLocator.selectors.mapNonAjax+"]"),o.activeMap.length<1||(o.toggleLoading(!0),o.setMapIndex(),o.loadMap())})},o.setMapIndex=function(){var t=e("["+SimpleLocator.selectors.resultsWrapper+"]");o.activeWrapper=e(o.activeMap).parents("["+SimpleLocator.selectors.resultsWrapper+"]"),o.mapIndex=e(o.activeWrapper).index(t)},o.loadMap=function(){SimpleLocator.markers[o.mapIndex]=[];var t=new google.maps.LatLngBounds,a={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:wpsl_locator.mapstyles,panControl:!1};"1"===wpsl_locator.custom_map_options&&(a=wpsl_locator.map_options);var r,i=[],n=new google.maps.InfoWindow;SimpleLocator.infoWindow=n,SimpleLocator.maps[o.mapIndex]=new google.maps.Map(o.activeMap[0],a),o.addUserPin();for(var s=0;s<simple_locator_results.length;s++){var l={title:simple_locator_results[s].title,lat:simple_locator_results[s].lat,lng:simple_locator_results[s].lng,id:simple_locator_results[s].id,mappin:simple_locator_results[s].mappin,infowindow:simple_locator_results[s].infowindow};i.push(l)}for(s=0;s<i.length;s++){var c=new google.maps.LatLng(i[s].lat,i[s].lng);t.extend(c),r=new google.maps.Marker({position:c,map:SimpleLocator.maps[o.mapIndex],title:i[s].title,icon:i[s].mappin}),google.maps.event.addListener(r,"click",function(t,a){return function(){n.setContent(i[a].infowindow),n.open(SimpleLocator.maps[o.mapIndex],t),e(document).trigger("simple-locator-marker-clicked",[t,a,o.activeWrapper,i[a].id]),wpsl_click_marker(t,a,o.activeWrapper,i[a].id)}}(r,s)),SimpleLocator.markers[o.mapIndex].push(r)}if(""!==wpsl_locator.includeuserpin){var p=o.addUserPin();t.extend(p)}SimpleLocator.maps[o.mapIndex].fitBounds(t);var m=google.maps.event.addListener(SimpleLocator.maps[o.mapIndex],"idle",function(){simple_locator_results.length<2&&""===wpsl_locator.includeuserpin&&SimpleLocator.maps[o.mapIndex].setZoom(13),google.maps.event.removeListener(m)});o.toggleLoading(!1),e(document).trigger("simple-locator-map-rendered",[o.mapIndex,o.activeWrapper])},o.addUserPin=function(){SimpleLocator.userPin[o.mapIndex]&&(SimpleLocator.userPin[o.mapIndex].setMap(null),SimpleLocator.userPin[o.mapIndex]=null);var t=wpsl_locator.mappinuser?wpsl_locator.mappinuser:"",a=parseFloat(e(o.activeMap).attr(o.selectors.latitude)),r=parseFloat(e(o.activeMap).attr(o.selectors.longitude)),i=new google.maps.LatLng(a,r);return marker=new google.maps.Marker({position:i,map:SimpleLocator.maps[o.mapIndex],icon:t}),SimpleLocator.userPin[o.mapIndex]=marker,i},o.toggleLoading=function(t){t?e(o.activeMap).addClass("loading"):(e(o.activeMap).show(),e(o.activeMap).removeClass("loading"))},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).ResultsMap=function(){var o=this,e=jQuery;return o.activeForm,o.activeFormContainer,o.activeMap,o.mapContainer,o.data,o.mapIndex,o.bindEvents=function(){e(document).on("simple-locator-form-success",function(t,a,r){o.activeForm=e(r),o.activeFormContainer=e(r).parents("["+SimpleLocator.selectors.formContainer+"]"),o.data=a,o.setMapContainer(),o.setMapIndex(),o.loadMap()})},o.setMapIndex=function(){var t=e("["+SimpleLocator.selectors.resultsWrapper+"]");o.mapIndex=e(t).index(o.activeFormContainer)},o.setMapContainer=function(){var t=e(o.activeForm).attr("data-simple-locator-map-container");o.activeMap=void 0!==t&&""!==t?e(t):e(o.activeFormContainer).find("["+SimpleLocator.selectors.map+"]")},o.loadMap=function(){o.removeMapMarkers();var t=new google.maps.LatLngBounds,a=new google.maps.InfoWindow;if(SimpleLocator.infoWindow=a,!SimpleLocator.maps[o.mapIndex]){var r=e(o.activeForm).attr("data-simple-locator-hide-map-controls");r=void 0!==r&&""!==r;var i=e(o.activeForm).attr("data-simple-locator-map-control-position");i=void 0===i||""===i?"TOP_LEFT":i;var n={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:wpsl_locator.mapstyles,panControl:!1,disableDefaultUI:r,zoomControlOptions:{position:google.maps.ControlPosition[i]}};"1"===wpsl_locator.custom_map_options&&(n=wpsl_locator.map_options),SimpleLocator.maps[o.mapIndex]=new google.maps.Map(o.activeMap[0],n)}for(var s=[],l=0,c=o.data.results.length;l<c;l++){var p={title:o.data.results[l].title,lat:o.data.results[l].latitude,lng:o.data.results[l].longitude,id:o.data.results[l].id,mappin:o.data.results[l].mappin,infowindow:o.data.results[l].infowindow};s.push(p)}for(l=0;l<s.length;l++){var m=new google.maps.LatLng(s[l].lat,s[l].lng);t.extend(m),marker=new google.maps.Marker({position:m,map:SimpleLocator.maps[o.mapIndex],title:s[l].title,icon:s[l].mappin}),google.maps.event.addListener(marker,"click",function(t,r){return function(){a.setContent(s[r].infowindow),a.open(SimpleLocator.maps[o.mapIndex],t),e(document).trigger("simple-locator-marker-clicked",[t,r,o.activeForm,s[r].id]),wpsl_click_marker(t,r,o.activeForm,s[r].id)}}(marker,l)),SimpleLocator.markers[o.mapIndex].push(marker)}if(""!==wpsl_locator.includeuserpin){var d=o.addUserPin();t.extend(d)}SimpleLocator.maps[o.mapIndex].fitBounds(t);var u=google.maps.event.addListener(SimpleLocator.maps[o.mapIndex],"idle",function(){o.data.results.length<2&&""===wpsl_locator.includeuserpin&&SimpleLocator.maps[o.mapIndex].setZoom(13),google.maps.event.removeListener(u)});o.toggleLoading(!1),e(document).trigger("simple-locator-map-rendered",[o.mapIndex,o.activeForm])},o.addUserPin=function(){SimpleLocator.userPin[o.mapIndex]&&(SimpleLocator.userPin[o.mapIndex].setMap(null),SimpleLocator.userPin[o.mapIndex]=null);var e=wpsl_locator.mappinuser?wpsl_locator.mappinuser:"",t=new google.maps.LatLng(o.data.latitude,o.data.longitude);return marker=new google.maps.Marker({position:t,map:SimpleLocator.maps[o.mapIndex],icon:e}),SimpleLocator.userPin[o.mapIndex]=marker,t},o.removeMapMarkers=function(){if(SimpleLocator.markers[o.mapIndex]){for(var e=0;e<SimpleLocator.markers[o.mapIndex].length;e++)SimpleLocator.markers[o.mapIndex][e].setMap(null);SimpleLocator.markers[o.mapIndex]=[]}else SimpleLocator.markers[o.mapIndex]=[]},o.toggleLoading=function(t){t?e(o.activeMap).addClass("loading"):(e(o.activeMap).show(),e(o.activeMap).removeClass("loading"))},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).ResultsList=function(){var o=this,e=jQuery;return o.activeForm,o.activeFormContainer,o.activeList,o.data,o.listIndex,o.paginated=!1,o.bindEvents=function(){e(document).on("simple-locator-form-success",function(t,a,r){o.activeForm=e(r),o.activeFormContainer=e(r).parents("["+SimpleLocator.selectors.formContainer+"]"),o.data=a,0!==o.data.per_page&&(o.paginated=!0),o.setListContainer(),o.setMapIndex(),o.loadList()})},o.setMapIndex=function(){var t=e("["+SimpleLocator.selectors.resultsWrapper+"]");o.listIndex=e(o.activeFormContainer).index(t)},o.setListContainer=function(){var t=e(o.activeForm).attr("data-simple-locator-results-container");o.activeList=void 0!==t&&""!==t?e(t):e(o.activeFormContainer).find("["+SimpleLocator.selectors.results+"]")},o.loadList=function(){if(o.data.result_count<1)return e(o.activeFormContainer).find("["+SimpleLocator.selectors.error+"]").text(wpsl_locator_options.noresultstext).show(),e(o.activeList).hide(),e(o.activeFormContainer).find("["+SimpleLocator.selectors.map+"]").hide(),void wpsl_no_results(data.formatted_address,active_form);var t=1===o.data.result_count?wpsl_locator.location:wpsl_locator.locations,a="",r='<h3 class="wpsl-results-header">'+o.data.result_count+" "+t;""!==o.data.latitude&&(r+=" "+wpsl_locator.found_within+" "+o.data.distance+" "+o.data.unit+" "+wpsl_locator.of+" "),r+="true"===o.data.geolocation?wpsl_locator.yourlocation:o.data.formatted_address,r+="</h3>",o.paginated&&o.data.results_header&&(r=o.data.results_header,o.data.current_counts&&o.data.total_pages>1&&(r+=o.data.current_counts)),a+=r;var n="undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options;for(n&&""!==wpsl_locator_options.resultswrapper&&(a+="<"+wpsl_locator_options.resultswrapper+">"),i=0;i<o.data.results.length;i++)a+=o.data.results[i].output;n&&""!==wpsl_locator_options.resultswrapper&&(a+="</"+wpsl_locator_options.resultswrapper+">"),o.paginated&&o.data.total_pages>1&&(a+='<div class="simple-locator-ajax-pagination">',o.data.back_button&&(a+=o.data.back_button),o.data.next_button&&(a+=o.data.next_button),o.data.loading_spinner&&(a+=o.data.loading_spinner),o.data.page_jump_form&&(a+=o.data.page_jump_form),o.data.page_position&&(a+=o.data.page_position),a+="</div>"),o.toggleLoading(!1),e(o.activeList).removeClass("loading").html(a),e(document).trigger("simple-locator-results-rendered",[o.listIndex,o.activeForm]),wpsl_after_render(o.activeList)},o.toggleLoading=function(t){t?e(o.activeFormContainer).addClass("loading"):e(o.activeFormContainer).removeClass("loading")},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).InfoWindowOpen=function(){var o=this,e=jQuery;return o.mapIndex,o.markerIndex,o.bindEvents=function(){e(document).on("click","["+SimpleLocator.selectors.infoWindowLink+"]",function(t){t.preventDefault(),o.setIndexes(e(this)),o.openInfoWindow()})},o.setIndexes=function(t){var a=e(t).parents("["+SimpleLocator.selectors.resultsWrapper+"]"),r=e("["+SimpleLocator.selectors.resultsWrapper+"]");o.mapIndex=e(a).index(r),o.markerIndex=parseInt(e(t).attr(SimpleLocator.selectors.infoWindowLink))},o.openInfoWindow=function(){google.maps.event.trigger(SimpleLocator.markers[o.mapIndex][o.markerIndex],"click"),e(document).trigger("simple-locator-infowindow-opened",[o.mapIndex,o.markerIndex])},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).Geolocation=function(){var o=this,e=jQuery;return o.geolocationAvailable=!0,o.activeForm,o.activeFormContainer,o.bindEvents=function(){e(document).ready(function(){o.setGeolocationAvailable()}),e(document).on("simple-locator-geolocation-available-set",function(){o.geolocationAvailable&&(o.appendButton(),o.setDefaultUserLocation())}),e(document).on("click","["+SimpleLocator.selectors.geoButton+"]",function(t){t.preventDefault(),o.activeForm=e(this).parents("["+SimpleLocator.selectors.form+"]"),o.activeFormContainer=e(this).parents("["+SimpleLocator.selectors.formContainer+"]"),o.toggleLoading(!0),o.getLocation()})},o.appendButton=function(){var o='<button class="wpsl-geo-button" '+SimpleLocator.selectors.geoButton+">"+wpsl_locator.geobuttontext+"</button>";e(".geo_button_cont").html(o)},o.setDefaultUserLocation=function(){if("true"===wpsl_locator.default_user_center){var t=e("[data-simple-locator-default-enabled]");o.activeFormContainer=e(t).parents("["+SimpleLocator.selectors.formContainer+"]"),o.activeForm=e(o.activeFormContainer).find("["+SimpleLocator.selectors.form+"]"),e(o.activeFormContainer).addClass("loading"),o.getLocation()}},o.setGeolocationAvailable=function(){if("true"===wpsl_locator.showgeobutton){if(e("["+SimpleLocator.selectors.formContainer+"]").removeClass("no-geolocation"),!navigator.geolocation)return!1;navigator.permissions.query({name:"geolocation"}).then(function(t){"denied"==t.state&&(o.geolocationAvailable=!1,e("["+SimpleLocator.selectors.formContainer+"]").addClass("no-geolocation")),e(document).trigger("simple-locator-geolocation-available-set",[o.geolocationAvailable])})}},o.getLocation=function(){navigator.geolocation.getCurrentPosition(function(t){var a={latitude:t.coords.latitude,longitude:t.coords.longitude};e(o.activeFormContainer).addClass("has-geolocation"),e(document).trigger("simple-locator-geolocation-success",[o.activeForm,a])},function(t){e(document).trigger("simple-locator-error",[o.activeForm,"Your location could not be determined"]),o.toggleLoading(!1)})},o.toggleLoading=function(t){if(t)return e("["+SimpleLocator.selectors.inputAddress+"]").val(""),e("["+SimpleLocator.selectors.inputLatitude+"]").val(""),e("["+SimpleLocator.selectors.inputLongitude+"]").val(""),e("["+SimpleLocator.selectors.inputGeocode+"]").val(""),e("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(""),e(o.activeFormContainer).addClass("loading"),void e(o.activeFormContainer).find("["+SimpleLocator.selectors.formError+"]").hide();e(o.activeFormContainer).removeClass("loading")},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).PlacesAutocomplete=function(){var o=this,e=jQuery;return o.selectors={input:"data-simple-locator-autocomplete"},o.bindEvents=function(){e(document).ready(function(){o.enableAutocomplete()})},o.enableAutocomplete=function(){var t=e("["+o.selectors.input+"]");e.each(t,function(o,t){var a={};wpsl_locator.custom_autocomplete&&(a=wpsl_locator.autocomplete_options);var r=new google.maps.places.Autocomplete(this,a),i=(e(this).parents("["+SimpleLocator.selectors.form+"]").find("["+SimpleLocator.selectors.submitButton+"]"),e(this).parents("form"));google.maps.event.addListener(r,"place_changed",function(){e(document).trigger("simple-locator-autocomplete-changed",[r.getPlace(),i])})})},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).DefaultMap=function(){var o=this,e=jQuery;return o.mapIndex,o.selectors={map:"data-simple-locator-default-enabled"},o.bindEvents=function(){e(document).ready(function(){"true"!==wpsl_locator.default_user_center&&o.queueDefaultMaps()})},o.queueDefaultMaps=function(t){var a=e("["+o.selectors.map+"]");e.each(a,function(){var t=e(this);o.setMapIndex(t),o.loadDefault(t)})},o.setMapIndex=function(t){var a=e("["+SimpleLocator.selectors.resultsWrapper+"]"),r=e(t).parents("["+SimpleLocator.selectors.resultsWrapper+"]");o.mapIndex=e(a).index(r)},o.loadDefault=function(t){var a=wpsl_locator.default_latitude,r=wpsl_locator.default_longitude;e(t).removeClass("loading");var i=new google.maps.LatLng(a,r),n={center:i,zoom:parseInt(wpsl_locator.default_zoom),styles:wpsl_locator.mapstyles};"1"===wpsl_locator.custom_map_options&&(n=wpsl_locator.map_options),n.center=i,SimpleLocator.maps[o.mapIndex]=new google.maps.Map(t[0],n)},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).AllLocations=function(){var o=this,e=jQuery;return o.data,o.mapIndex,o.activeMap,o.formData={},o.paginated=!1,o.page=1,o.selectors={map:"data-simple-locator-all-locations-map",pagination:"data-simple-locator-all-results-pagination",pageJumpForm:"data-simple-locator-page-jump-form"},o.bindEvents=function(){e("["+o.selectors.map+"]").length<1||(e(document).ready(function(){o.getData()}),e(document).on("click","["+o.selectors.pagination+"] ["+SimpleLocator.selectors.paginationButton+"]",function(t){t.preventDefault(),o.paginate(e(this))}),e(document).on("submit","["+SimpleLocator.selectors.pageJumpForm+"]",function(t){var a=e(this).parents("["+SimpleLocator.selectors.resultsWrapper+"]");e(a).hasClass("non-ajax")||(t.preventDefault(),o.jumpToPage(e(this)))}))},o.setMapIndex=function(){var t=e("["+SimpleLocator.selectors.map+"]");o.mapIndex=e(o.activeMap).index(t)},o.setTaxonomyArgs=function(){var t=e(o.activeMap).data(),a={};e.each(t,function(o,e){if(0===o.indexOf("taxfilter")){var t=o.substring(9).toLowerCase(),r="number"!=typeof e?e.split(","):[e];a[t]=r}}),o.formData.taxfilter=a},o.setLimitArgs=function(){limit=e(o.activeMap).attr("data-limit"),o.formData.limit="undefined"!=typeof limit&&""!==limit?limit:"-1"},o.setPerPageArgs=function(){perpage=e(o.activeMap).attr("data-per-page"),"undefined"!=typeof perpage&&""!==perpage&&(o.formData.per_page=parseInt(perpage),o.paginated=!0)},o.setIdArgs=function(){var t=e(o.activeMap).attr("data-post-ids");void 0!==t&&""!==t&&(o.formData.ids=t)},o.setLocationArgs=function(){var e=wpsl_locator.default_latitude,t=wpsl_locator.default_longitude,a=wpsl_locator.default_enabled;if(void 0!==a&&""!==a)return void 0!==e&&""!==e?(o.formData.latitude=e,o.formData.longitude=t,void(o.formData.distance=5e3)):void(o.formData.allow_empty_address="true");o.formData.allow_empty_address="true"},o.getData=function(){var t=e("["+o.selectors.map+"]");e.each(t,function(){o.activeMap=e(this),o.setMapIndex();var t=e(this).parents("["+SimpleLocator.selectors.formContainer+"]").find("["+SimpleLocator.selectors.form+"]");void 0!==t&&""!==t&&t.length>0&&"1"!==wpsl_locator.default_enabled||(o.formData.page=o.page,o.setLocationArgs(),o.setPerPageArgs(),o.setTaxonomyArgs(),o.setLimitArgs(),o.setIdArgs(),e.ajax({url:SimpleLocator.endpoints.search,type:"GET",datatype:"json",data:o.formData,success:function(e){if(!e.results)return o.noLocations();SimpleLocator.formData[o.mapIndex]=e,SimpleLocator.formData[o.mapIndex].allLocations=!0,o.data=e,o.loadMap()},error:function(o){"1"===wpsl_locator.jsdebug&&console.log("All Locations Error")}}))})},o.loadMap=function(){SimpleLocator.markers[o.mapIndex]=[];var t=o.data.results,a=wpsl_locator.mapstyles,r=new google.maps.LatLngBounds,i={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:a,panControl:!1};"1"===wpsl_locator.custom_map_options&&(i=wpsl_locator.map_options);var n,s=new google.maps.InfoWindow;SimpleLocator.infoWindow=s;var l=new google.maps.Map(e(o.activeMap)[0],i);for(n=0;n<t.length;n++){var c=new google.maps.LatLng(t[n].latitude,t[n].longitude);r.extend(c);var p=new google.maps.Marker({position:c,map:l,title:t[n].title,icon:t[n].mappin});google.maps.event.addListener(p,"click",function(o,a){return function(){s.setContent(t[a].infowindow),s.open(l,o),e(document).trigger("simple-locator-all-locations-marker-clicked",[o,s]),wpsl_all_locations_marker_clicked(o,s)}}(p,n)),SimpleLocator.markers[o.mapIndex].push(p),l.fitBounds(r);var m=google.maps.event.addListener(l,"idle",function(){t.length<2&&l.setZoom(13),google.maps.event.removeListener(m)})}SimpleLocator.maps[o.mapIndex]=l,o.loadList(),e(document).trigger("simple-locator-all-locations-rendered",[l]),wpsl_all_locations_rendered(l)},o.noLocations=function(){var t=e(o.activeMap).attr("data-no-results-text");t=void 0===t||""===t?wpsl_locator.nolocationsfound:t,e("<p>"+t+"</p>").insertAfter(o.activeMap),e(o.activeMap).hide()},o.loadList=function(){var t=e(o.activeMap).attr("data-include-listing");if(void 0!==t&&"true"===t){var a=e(o.activeMap).parents("["+SimpleLocator.selectors.formContainer+"]");if(a.length<1)(r=e(o.activeMap).siblings("[data-simple-locator-results-container]")).length<1&&(r=e("<div data-simple-locator-results-container><div "+SimpleLocator.selectors.results+' class="wpsl-results"></div></div>').insertAfter(o.activeMap));else var r=e(a).find("["+SimpleLocator.selectors.results+"]");var n=e(o.activeMap).attr(o.selectors.map),s="";s+=(n=void 0!==n&&""!==n&&"true"!==n&&'<h3 class="wpsl-results-header">'+n+"</h3>")||o.data.results_header+o.data.current_counts;var l="undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options;for(l&&""!==wpsl_locator_options.resultswrapper&&(s+="<"+wpsl_locator_options.resultswrapper+">"),i=0;i<o.data.results.length;i++)s+=o.data.results[i].output;l&&""!==wpsl_locator_options.resultswrapper&&(s+="</"+wpsl_locator_options.resultswrapper+">"),o.paginated&&o.data.total_pages>1&&(s+='<div class="simple-locator-ajax-pagination" data-simple-locator-all-results-pagination>',o.data.back_button&&(s+=o.data.back_button),o.data.next_button&&(s+=o.data.next_button),o.data.loading_spinner&&(s+=o.data.loading_spinner),o.data.page_jump_form&&(s+=o.data.page_jump_form),o.data.page_position&&(s+=o.data.page_position),s+="</div>"),e(r).removeClass("loading").html(s),e(r).parents("["+SimpleLocator.selectors.formContainer+"]").removeClass("loading")}},o.paginate=function(t){if(e(t).siblings(".wpsl-icon-spinner").addClass("visible"),"next"===e(t).attr(SimpleLocator.selectors.paginationButton))return o.page=o.page+1,void o.getData();o.page=o.page-1,o.getData()},o.jumpToPage=function(t){var a=parseInt(e(t).find('input[type="tel"]').val());if(!isNaN(a)){var r=SimpleLocator.formData[o.mapIndex].total_pages;if(!(void 0!==r&&a>r)){var i=e(t).parents("["+SimpleLocator.selectors.formContainer+"]"),n=e(i).index("["+SimpleLocator.selectors.formContainer+"]");SimpleLocator.formData[n].allLocations&&(e(i).addClass("loading"),o.page=a,o.getData())}}},o.bindEvents()},(SimpleLocator=SimpleLocator||{}).Errors=function(){var o=this,e=jQuery;return o.error,o.form,o.formContainer,o.bindEvents=function(){e(document).on("simple-locator-error",function(t,a,r){o.form=a,o.formContainer=e(a).parents("["+SimpleLocator.selectors.formContainer+"]"),o.toggleError(r),e(document).trigger("simple-locator-error-message",[a,r]),o.clearMap(),wpsl_error(r,o.form)})},o.toggleError=function(t){e(o.formContainer).removeClass("loading"),e(o.formContainer).find("["+SimpleLocator.selectors.formError+"]").text(t).show()},o.clearMap=function(){var t=e("["+SimpleLocator.selectors.resultsWrapper+"]"),a=e(o.formContainer).index(t);SimpleLocator.markers[a]||(SimpleLocator.markers[a]=[]);for(var r=0;r<SimpleLocator.markers[a].length;r++)SimpleLocator.markers[a][r].setMap(null);SimpleLocator.markers[a]=[],""!==wpsl_locator.includeuserpin&&SimpleLocator.userPin[a]&&(SimpleLocator.userPin[a].setMap(null),SimpleLocator.userPin[a]=null)},o.bindEvents()},jQuery(document).ready(function(){new SimpleLocator.Factory}),(SimpleLocator=SimpleLocator||{}).selectors={resultsWrapper:"data-simple-locator-results-wrapper",form:"data-simple-locator-form",formContainer:"data-simple-locator-form-container",formError:"data-simple-locator-form-error",results:"data-simple-locator-results",map:"data-simple-locator-map",mapNonAjax:"data-simple-locator-map-non-ajax",inputAddress:"data-simple-locator-input-address",inputLatitude:"data-simple-locator-input-latitude",inputLongitude:"data-simple-locator-input-longitude",inputUnit:"data-simple-locator-input-unit",inputDistance:"data-simple-locator-input-distance",inputFormattedLocation:"data-simple-locator-input-formatted-location",inputGeocode:"data-simple-locator-input-geocode",inputLimit:"data-simple-locator-input-limit",submitButton:"data-simple-locator-submit",infoWindowLink:"data-simple-locator-open-infowindow",geoButton:"data-simple-locator-geolocation-button",ajaxForm:"data-simple-locator-ajax-form",paginationButton:"data-simple-locator-pagination",pageJumpForm:"data-simple-locator-page-jump-form"},SimpleLocator.endpoints={search:wpsl_locator.rest_url+"/search",locations:wpsl_locator.rest_url+"/locations"},SimpleLocator.maps=[],SimpleLocator.markers=[],SimpleLocator.userPin=[],SimpleLocator.formData=[],SimpleLocator.infoWindow,SimpleLocator.mapservice=wpsl_locator.mapservice,SimpleLocator.Factory=function(){jQuery;return this.init=function(){new SimpleLocator.Geocoder,new SimpleLocator.Geolocation,new SimpleLocator.PlacesAutocomplete,new SimpleLocator.DefaultMap,new SimpleLocator.ResultsMapNonAjax,new SimpleLocator.SingleLocation,new SimpleLocator.AllLocations,new SimpleLocator.Form,new SimpleLocator.ResultsMap,new SimpleLocator.ResultsList,new SimpleLocator.InfoWindowOpen,new SimpleLocator.Errors},this.init()};