var SimpleLocator,active_form="",formatted_address="",googlemaps_response="";function openInfoWindow(o){google.maps.event.trigger(SimpleLocator.markers[0][o],"click");var e=SimpleLocator.markers[0][o].getPosition().lat(),t=SimpleLocator.markers[0][o].getPosition().lng(),a=new google.maps.LatLng(e,t);return SimpleLocator.maps[0].panTo(a),SimpleLocator.maps[0].fitBounds(a),SimpleLocator.maps[0].setZoom(12),!1}function wpsl_before_submit(o,e){}function wpsl_after_render(o){}function wpsl_click_marker(o,e,t,a){}function wpsl_no_results(o,e){}function wpsl_error(o,e){}function wpsl_success(o,e,t){}function wpsl_googlemaps_response(){return googlemaps_response}function wpsl_all_locations_rendered(o){}function wpsl_all_locations_marker_clicked(o,e){}function wpsl_googlemaps_response(){return googlemaps_response}(SimpleLocator=SimpleLocator||{}).SingleLocation=function(){var l=this,c=jQuery;return l.selectors={mapContainer:"data-simple-locator-single-map",latitude:"data-latitude",longitude:"data-longitude",title:"data-title"},l.bindEvents=function(){c(document).ready(function(){l.loadAllMaps()})},l.loadAllMaps=function(){var o=c("["+l.selectors.mapContainer+"]");c.each(o,function(){l.loadMap(c(this))})},l.loadMap=function(o){var e=parseFloat(c(o).attr(l.selectors.latitude)),t=parseFloat(c(o).attr(l.selectors.longitude)),a=c(o).attr(l.selectors.title),r=wpsl_locator.mappin?wpsl_locator.mappin:"",i=new google.maps.LatLng(e,t),n={zoom:12,styles:wpsl_locator.mapstyles};"1"===wpsl_locator.custom_map_options&&(n=wpsl_locator.map_options),n.center=i;var s=new google.maps.Map(o[0],n);new google.maps.Marker({position:i,map:s,icon:r,title:a});c(o).removeClass("loading")},l.bindEvents()},(SimpleLocator=SimpleLocator||{}).Form=function(){var s=this,l=jQuery;return s.activeForm,s.activeFormContainer,s.isWidget=!1,s.mapContainer,s.resultsContainer,s.formData,s.isAjax=!1,s.page=1,s.formIndex,s.bindEvents=function(){l(document).on("click","["+SimpleLocator.selectors.submitButton+"]",function(o){o.preventDefault(),s.activeForm=l(this).parents("["+SimpleLocator.selectors.form+"]"),s.activeFormContainer=l(this).parents("["+SimpleLocator.selectors.formContainer+"]"),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),s.setAjax(),active_form=s.activeForm,wpsl_before_submit(s.activeForm),l(document).trigger("simple-locator-before-submit",[s.activeForm]),s.processForm()}),l(document).on("simple-locator-submit-form",function(o,e){console.log(e),s.activeForm=e,s.activeFormContainer=l(e).parents("["+SimpleLocator.selectors.formContainer+"]"),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),s.setAjax(),active_form=s.activeForm,wpsl_before_submit(s.activeForm),l(document).trigger("simple-locator-before-submit",[s.activeForm]),s.processForm()}),l(document).on("simple-locator-geolocation-success",function(o,e,t){s.activeForm=l(e),s.activeFormContainer=l(e).parents("["+SimpleLocator.selectors.formContainer+"]"),l(s.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(t.latitude),l(s.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(t.longitude),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val("1"),s.setAjax(),wpsl_before_submit(s.activeForm),l(document).trigger("simple-locator-before-submit",[s.activeForm]),s.setResultsContainers(),s.setFormData(),s.submitForm()}),l(document).on("simple-locator-address-geocoded",function(o,e,t){s.toggleLoading(!0,!0),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),l(s.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(e.latitude),l(s.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(e.longitude),l(s.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(e.formatted_address),s.setFormData(),s.submitForm()}),l(document).on("click","["+SimpleLocator.selectors.paginationButton+"]",function(o){s.activeForm&&(l(s.activeFormContainer).hasClass("has-geolocation")&&!s.isAjax||(o.preventDefault(),l(s.activeFormContainer).addClass("loading"),s.paginate(l(this))))}),l(document).on("simple-locator-autocomplete-changed",function(o,e,t){s.activeForm=l(t),s.activeFormContainer=l(t).parents("["+SimpleLocator.selectors.formContainer+"]"),s.setAjax(),s.toggleLoading(!0,!0),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),l(s.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(e.geometry.location.lat()),l(s.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(e.geometry.location.lng()),l(s.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(e.formatted_address),1<s.page&&(s.page=1),s.setFormData(),s.submitForm()}),l(document).on("submit","["+SimpleLocator.selectors.pageJumpForm+"]",function(o){var e=l(this).parents("["+SimpleLocator.selectors.resultsWrapper+"]");l(e).hasClass("non-ajax")||(o.preventDefault(),s.jumpToPage(l(this)))})},s.setAjax=function(){var o=l(s.activeForm).attr(SimpleLocator.selectors.ajaxForm);s.isAjax=void 0!==o&&"true"===o},s.processForm=function(o){s.toggleLoading(!0,!0),s.setResultsContainers(),(new SimpleLocator.Geocoder).getCoordinates(s.activeForm)},s.setResultsContainers=function(){0<l(s.activeForm).siblings("#widget").length&&(s.isWidget=!0),"undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options||(wpsl_locator_options=""),s.mapContainer=""===wpsl_locator_options.mapcont||s.isWidget?l(s.activeFormContainer).find("["+SimpleLocator.selectors.map+"]"):l(wpsl_locator_options.mapcont),s.resultsContainer=""===wpsl_locator_options.resultscontainer||s.isWidget?s.activeFormContainer.find("["+SimpleLocator.selectors.results+"]"):l(wpsl_locator_options.resultscontainer)},s.setFormData=function(){var o=l(s.activeForm).attr("data-simple-locator-form-allow-empty");o=void 0!==o&&""!==o;var e=l(s.activeForm).find("["+SimpleLocator.selectors.inputAddress+"]");e=void 0!==e&&l(e).val();var t=l(s.activeForm).find("["+SimpleLocator.selectors.inputDistance+"]");t=void 0!==t&&l(t).val();var a=l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val();a=""!==a&&"false"!==a;var r=l(s.activeForm).find("["+SimpleLocator.selectors.inputLimit+"]").val();if(r=""===r?null:r,s.formData={address:e,formatted_address:l(s.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(),distance:t,latitude:l(s.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(),longitude:l(s.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(),unit:l(s.activeForm).find("["+SimpleLocator.selectors.inputUnit+"]").val(),geolocation:a,allow_empty_address:o,ajax:s.isAjax,per_page:r,page:s.page},s.setTaxonomies(),0!=wpsl_locator.postfields.length)for(var i=0;i<wpsl_locator.postfields.length;i++){var n=wpsl_locator.postfields[i];s.formData[n]=l("*[name="+n+"]").val()}},s.setTaxonomies=function(){var o=l(s.activeForm).find("[data-simple-locator-taxonomy-checkbox]:checked"),e=l(s.activeForm).find("[data-simple-locator-taxonomy-select]"),a={};l.each(e,function(o,e){""!==l(this).val()&&(a[l(this).attr("data-simple-locator-taxonomy-select")]=[l(this).val()])}),l.each(o,function(o,e){var t=l(this).attr("data-simple-locator-taxonomy-checkbox");a[t]instanceof Array||(a[t]=[]),a[t].push(parseInt(l(this).val()))}),s.formData.taxfilter=a},s.setAutoload=function(){var o=l(s.activeFormContainer).hasClass("has-geolocation");s.formData.autoload=o,s.formData.formmethod=l(s.activeForm).attr("method"),s.formData.resultspage=l(s.activeForm).find('input[name="results_page"]').val(),s.formData.mapheight=l(s.activeForm).find('input[name="mapheight"]').val(),s.formData.search_page=l(s.activeForm).find('input[name="search_page"]').val()},s.setFormIndex=function(){var o=l("["+SimpleLocator.selectors.form+"]");s.formIndex=l(s.activeForm).index(o)},s.submitForm=function(){s.setFormIndex(),s.setAutoload(),s.formData.ajax||s.formData.autoload?(s.formData.page=s.page,l.ajax({url:SimpleLocator.endpoints.search,type:"GET",datatype:"jsonp",data:s.formData,beforeSend:function(o,e){"1"===wpsl_locator.jsdebug&&(console.log("Form Data"),console.log(s.formData),console.log("URL"),console.log(e.url))},success:function(o){if(SimpleLocator.formData[s.formIndex]=o,SimpleLocator.formData[s.formIndex].allLocations=!1,"1"===wpsl_locator.jsdebug&&(console.log("Form Response"),console.log(o)),"error"===o.status)return l(document).trigger("simple-locator-error",[s.activeForm,o.message]),void s.toggleLoading(!1,!0);if(0===o.result_count){var e=wpsl_locator.nolocationserror+" "+o.formatted_address;return l(document).trigger("simple-locator-error",[s.activeForm,e]),wpsl_no_results(s.formData.formatted_address,s.activeForm),void s.toggleLoading(!1,!0)}l(document).trigger("simple-locator-form-success",[o,s.activeForm]),wpsl_success(o.result_count,o.results,s.activeForm)},error:function(o){"1"===wpsl_locator.jsdebug&&(console.log("Form Response Error"),console.log(o.responseText))}})):l(s.activeForm).submit()},s.paginate=function(o){var e=l(o).parents("["+SimpleLocator.selectors.formContainer+"]"),t=l(e).index("["+SimpleLocator.selectors.formContainer+"]");if(!SimpleLocator.formData[t].allLocations){if("next"===l(o).attr(SimpleLocator.selectors.paginationButton))return s.page=s.page+1,void s.submitForm();s.page=s.page-1,s.submitForm()}},s.jumpToPage=function(o){var e=parseInt(l(o).find('input[type="tel"]').val());if(!isNaN(e)){s.activeFormContainer=l(o).parents("["+SimpleLocator.selectors.formContainer+"]"),s.activeForm=l(s.activeFormContainer).find("["+SimpleLocator.selectors.form+"]"),s.formIndex=l(s.activeFormContainer).index("["+SimpleLocator.selectors.formContainer+"]");var t=SimpleLocator.formData[s.formIndex].total_pages;void 0!==t&&t<e||void 0!==SimpleLocator.formData[s.formIndex]&&""!==SimpleLocator.formData[s.formIndex]&&(SimpleLocator.formData[s.formIndex].allLocations||(l(s.activeFormContainer).addClass("loading"),s.page=e,s.submitForm()))}},s.toggleLoading=function(o,e){l(document).trigger("simple-locator-form-loading",[o]);var t=l(s.activeFormContainer).find("["+SimpleLocator.selectors.results+"]");if(o)return e&&(l("["+SimpleLocator.selectors.inputLatitude+"]").val(""),l("["+SimpleLocator.selectors.inputLongitude+"]").val(""),l("["+SimpleLocator.selectors.inputGeocode+"]").val(""),l("["+SimpleLocator.selectors.inputFormattedLocation+"]").val("")),l(s.activeFormContainer).addClass("loading"),l(s.activeFormContainer).find("["+SimpleLocator.selectors.formError+"]").hide(),void l(t).empty();l(s.activeFormContainer).removeClass("loading")},s.bindEvents()},(SimpleLocator=SimpleLocator||{}).Geocoder=function(){var t=this,a=jQuery;t.form,t.searchTerm,t.results=[],t.getCoordinates=function(o){t.form=o,t.searchTerm=a(t.form).find("["+SimpleLocator.selectors.inputAddress+"]").val();var e=a(t.form).attr("data-simple-locator-form-allow-empty");void 0===e||"true"!=e||void 0!==t.searchTerm&&""!=t.searchTerm?"google"===SimpleLocator.mapservice&&t.queryGoogleMaps():a(document).trigger("simple-locator-address-geocoded",[t.results,t.form])},t.queryGoogleMaps=function(){geocoder=new google.maps.Geocoder,geocoder.geocode({address:t.searchTerm},function(o,e){e==google.maps.GeocoderStatus.OK?(googlemaps_response=o,t.results.latitude=o[0].geometry.location.lat(),t.results.longitude=o[0].geometry.location.lng(),t.results.formatted_address=o[0].formatted_address,"1"===wpsl_locator.jsdebug&&(console.log("Google Geocode Response"),console.log(t.results)),a(document).trigger("simple-locator-address-geocoded",[t.results,t.form])):(a(document).trigger("simple-locator-error",[t.form,wpsl_locator.notfounderror]),t.removeLoading())})},t.removeLoading=function(){a(t.form).parents("["+SimpleLocator.selectors.formContainer+"]").removeClass("loading")}},(SimpleLocator=SimpleLocator||{}).ResultsMapNonAjax=function(){var p=this,m=jQuery;return p.activeMap,p.activeWrapper,p.mapIndex,p.selectors={latitude:"data-latitude",longitude:"data-longitude"},p.bindEvents=function(){m(document).ready(function(){p.activeMap=m("["+SimpleLocator.selectors.mapNonAjax+"]"),p.activeMap.length<1||(p.toggleLoading(!0),p.setMapIndex(),p.loadMap())})},p.setMapIndex=function(){var o=m("["+SimpleLocator.selectors.resultsWrapper+"]");p.activeWrapper=m(p.activeMap).parents("["+SimpleLocator.selectors.resultsWrapper+"]"),p.mapIndex=m(p.activeWrapper).index(o)},p.loadMap=function(){SimpleLocator.markers[p.mapIndex]=[];var o=new google.maps.LatLngBounds,e={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:wpsl_locator.mapstyles,panControl:!1};"1"===wpsl_locator.custom_map_options&&(e=wpsl_locator.map_options);var t,a=[],r=new google.maps.InfoWindow;SimpleLocator.infoWindow=r,SimpleLocator.maps[p.mapIndex]=new google.maps.Map(p.activeMap[0],e),p.addUserPin();for(var i=0;i<simple_locator_results.length;i++){var n={title:simple_locator_results[i].title,lat:simple_locator_results[i].lat,lng:simple_locator_results[i].lng,id:simple_locator_results[i].id,mappin:simple_locator_results[i].mappin,infowindow:simple_locator_results[i].infowindow};a.push(n)}for(i=0;i<a.length;i++){var s=new google.maps.LatLng(a[i].lat,a[i].lng);o.extend(s),t=new google.maps.Marker({position:s,map:SimpleLocator.maps[p.mapIndex],title:a[i].title,icon:a[i].mappin}),google.maps.event.addListener(t,"click",function(o,e){return function(){r.setContent(a[e].infowindow),r.open(SimpleLocator.maps[p.mapIndex],o),m(document).trigger("simple-locator-marker-clicked",[o,e,p.activeWrapper,a[e].id]),wpsl_click_marker(o,e,p.activeWrapper,a[e].id)}}(t,i)),SimpleLocator.markers[p.mapIndex].push(t)}if(""!==wpsl_locator.includeuserpin){var l=p.addUserPin();o.extend(l)}SimpleLocator.maps[p.mapIndex].fitBounds(o);var c=google.maps.event.addListener(SimpleLocator.maps[p.mapIndex],"idle",function(){simple_locator_results.length<2&&""===wpsl_locator.includeuserpin&&SimpleLocator.maps[p.mapIndex].setZoom(13),google.maps.event.removeListener(c)});p.toggleLoading(!1),m(document).trigger("simple-locator-map-rendered",[p.mapIndex,p.activeWrapper])},p.addUserPin=function(){SimpleLocator.userPin[p.mapIndex]&&(SimpleLocator.userPin[p.mapIndex].setMap(null),SimpleLocator.userPin[p.mapIndex]=null);var o=wpsl_locator.mappinuser?wpsl_locator.mappinuser:"",e=parseFloat(m(p.activeMap).attr(p.selectors.latitude)),t=parseFloat(m(p.activeMap).attr(p.selectors.longitude)),a=new google.maps.LatLng(e,t);return marker=new google.maps.Marker({position:a,map:SimpleLocator.maps[p.mapIndex],icon:o}),SimpleLocator.userPin[p.mapIndex]=marker,a},p.toggleLoading=function(o){o?m(p.activeMap).addClass("loading"):(m(p.activeMap).show(),m(p.activeMap).removeClass("loading"))},p.bindEvents()},(SimpleLocator=SimpleLocator||{}).ResultsMap=function(){var d=this,u=jQuery;return d.activeForm,d.activeFormContainer,d.activeMap,d.mapContainer,d.data,d.mapIndex,d.bindEvents=function(){u(document).on("simple-locator-form-success",function(o,e,t){d.activeForm=u(t),d.activeFormContainer=u(t).parents("["+SimpleLocator.selectors.formContainer+"]"),d.data=e,d.setMapContainer(),d.setMapIndex(),d.loadMap()})},d.setMapIndex=function(){var o=u("["+SimpleLocator.selectors.resultsWrapper+"]");d.mapIndex=u(o).index(d.activeFormContainer)},d.setMapContainer=function(){var o=u(d.activeForm).attr("data-simple-locator-map-container");d.activeMap=void 0!==o&&""!==o?u(o):u(d.activeFormContainer).find("["+SimpleLocator.selectors.map+"]")},d.loadMap=function(){d.removeMapMarkers();var o=new google.maps.LatLngBounds,t=new google.maps.InfoWindow;if(SimpleLocator.infoWindow=t,!SimpleLocator.maps[d.mapIndex]){var e=u(d.activeForm).attr("data-simple-locator-hide-map-controls");e=void 0!==e&&""!==e;var a=u(d.activeForm).attr("data-simple-locator-map-control-position");a=void 0===a||""===a?"TOP_LEFT":a;var r={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:wpsl_locator.mapstyles,panControl:!1,disableDefaultUI:e,zoomControlOptions:{position:google.maps.ControlPosition[a]}};"1"===wpsl_locator.custom_map_options&&(r=wpsl_locator.map_options),SimpleLocator.maps[d.mapIndex]=new google.maps.Map(d.activeMap[0],r)}for(var i=[],n=0,s=d.data.results.length;n<s;n++){var l={title:d.data.results[n].title,lat:d.data.results[n].latitude,lng:d.data.results[n].longitude,id:d.data.results[n].id,mappin:d.data.results[n].mappin,infowindow:d.data.results[n].infowindow};i.push(l)}for(n=0;n<i.length;n++){var c=new google.maps.LatLng(i[n].lat,i[n].lng);o.extend(c),marker=new google.maps.Marker({position:c,map:SimpleLocator.maps[d.mapIndex],title:i[n].title,icon:i[n].mappin}),google.maps.event.addListener(marker,"click",function(o,e){return function(){t.setContent(i[e].infowindow),t.open(SimpleLocator.maps[d.mapIndex],o),u(document).trigger("simple-locator-marker-clicked",[o,e,d.activeForm,i[e].id]),wpsl_click_marker(o,e,d.activeForm,i[e].id)}}(marker,n)),SimpleLocator.markers[d.mapIndex].push(marker)}if(""!==wpsl_locator.includeuserpin){var p=d.addUserPin();o.extend(p)}SimpleLocator.maps[d.mapIndex].fitBounds(o);var m=google.maps.event.addListener(SimpleLocator.maps[d.mapIndex],"idle",function(){d.data.results.length<2&&""===wpsl_locator.includeuserpin&&SimpleLocator.maps[d.mapIndex].setZoom(13),google.maps.event.removeListener(m)});d.toggleLoading(!1),u(document).trigger("simple-locator-map-rendered",[d.mapIndex,d.activeForm])},d.addUserPin=function(){SimpleLocator.userPin[d.mapIndex]&&(SimpleLocator.userPin[d.mapIndex].setMap(null),SimpleLocator.userPin[d.mapIndex]=null);var o=wpsl_locator.mappinuser?wpsl_locator.mappinuser:"",e=new google.maps.LatLng(d.data.latitude,d.data.longitude);return marker=new google.maps.Marker({position:e,map:SimpleLocator.maps[d.mapIndex],icon:o}),SimpleLocator.userPin[d.mapIndex]=marker,e},d.removeMapMarkers=function(){if(SimpleLocator.markers[d.mapIndex]){for(var o=0;o<SimpleLocator.markers[d.mapIndex].length;o++)SimpleLocator.markers[d.mapIndex][o].setMap(null);SimpleLocator.markers[d.mapIndex]=[]}else SimpleLocator.markers[d.mapIndex]=[]},d.toggleLoading=function(o){o?u(d.activeMap).addClass("loading"):(u(d.activeMap).show(),u(d.activeMap).removeClass("loading"))},d.bindEvents()},(SimpleLocator=SimpleLocator||{}).ResultsList=function(){var r=this,n=jQuery;return r.activeForm,r.activeFormContainer,r.activeList,r.data,r.listIndex,r.paginated=!1,r.bindEvents=function(){n(document).on("simple-locator-form-success",function(o,e,t){r.activeForm=n(t),r.activeFormContainer=n(t).parents("["+SimpleLocator.selectors.formContainer+"]"),r.data=e,0!==r.data.per_page&&(r.paginated=!0),r.setListContainer(),r.setMapIndex(),r.loadList()})},r.setMapIndex=function(){var o=n("["+SimpleLocator.selectors.resultsWrapper+"]");r.listIndex=n(r.activeFormContainer).index(o)},r.setListContainer=function(){var o=n(r.activeForm).attr("data-simple-locator-results-container");r.activeList=void 0!==o&&""!==o?n(o):n(r.activeFormContainer).find("["+SimpleLocator.selectors.results+"]")},r.loadList=function(){if(r.data.result_count<1)return n(r.activeFormContainer).find("["+SimpleLocator.selectors.error+"]").text(wpsl_locator_options.noresultstext).show(),n(r.activeList).hide(),n(r.activeFormContainer).find("["+SimpleLocator.selectors.map+"]").hide(),void wpsl_no_results(data.formatted_address,active_form);var o=1===r.data.result_count?wpsl_locator.location:wpsl_locator.locations,e="",t='<h3 class="wpsl-results-header">'+r.data.result_count+" "+o;""!==r.data.latitude&&(t+=" "+wpsl_locator.found_within+" "+r.data.distance+" "+r.data.unit+" "+wpsl_locator.of+" "),t+="true"===r.data.geolocation?wpsl_locator.yourlocation:r.data.formatted_address,t+="</h3>",r.paginated&&r.data.results_header&&(t=r.data.results_header,r.data.current_counts&&1<r.data.total_pages&&(t+=r.data.current_counts)),e+=t;var a="undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options;for(a&&""!==wpsl_locator_options.resultswrapper&&(e+="<"+wpsl_locator_options.resultswrapper+">"),i=0;i<r.data.results.length;i++)e+=r.data.results[i].output;a&&""!==wpsl_locator_options.resultswrapper&&(e+="</"+wpsl_locator_options.resultswrapper+">"),r.paginated&&1<r.data.total_pages&&(e+='<div class="simple-locator-ajax-pagination">',r.data.back_button&&(e+=r.data.back_button),r.data.next_button&&(e+=r.data.next_button),r.data.loading_spinner&&(e+=r.data.loading_spinner),r.data.page_jump_form&&(e+=r.data.page_jump_form),r.data.page_position&&(e+=r.data.page_position),e+="</div>"),r.toggleLoading(!1),n(r.activeList).removeClass("loading").html(e),n(document).trigger("simple-locator-results-rendered",[r.listIndex,r.activeForm]),wpsl_after_render(r.activeList)},r.toggleLoading=function(o){o?n(r.activeFormContainer).addClass("loading"):n(r.activeFormContainer).removeClass("loading")},r.bindEvents()},(SimpleLocator=SimpleLocator||{}).InfoWindowOpen=function(){var a=this,r=jQuery;return a.mapIndex,a.markerIndex,a.bindEvents=function(){r(document).on("click","["+SimpleLocator.selectors.infoWindowLink+"]",function(o){o.preventDefault(),a.setIndexes(r(this)),a.openInfoWindow()})},a.setIndexes=function(o){var e=r(o).parents("["+SimpleLocator.selectors.resultsWrapper+"]"),t=r("["+SimpleLocator.selectors.resultsWrapper+"]");a.mapIndex=r(e).index(t),a.markerIndex=parseInt(r(o).attr(SimpleLocator.selectors.infoWindowLink))},a.openInfoWindow=function(){google.maps.event.trigger(SimpleLocator.markers[a.mapIndex][a.markerIndex],"click"),r(document).trigger("simple-locator-infowindow-opened",[a.mapIndex,a.markerIndex])},a.bindEvents()},(SimpleLocator=SimpleLocator||{}).Geolocation=function(){var t=this,a=jQuery;return t.geolocationAvailable=!0,t.activeForm,t.activeFormContainer,t.bindEvents=function(){a(document).ready(function(){t.setGeolocationAvailable()}),a(document).on("simple-locator-geolocation-available-set",function(){t.geolocationAvailable&&(t.appendButton(),t.setDefaultUserLocation())}),a(document).on("click","["+SimpleLocator.selectors.geoButton+"]",function(o){o.preventDefault(),t.activeForm=a(this).parents("["+SimpleLocator.selectors.form+"]"),t.activeFormContainer=a(this).parents("["+SimpleLocator.selectors.formContainer+"]"),t.toggleLoading(!0),t.getLocation()})},t.appendButton=function(){var o='<button class="wpsl-geo-button" '+SimpleLocator.selectors.geoButton+">"+wpsl_locator.geobuttontext+"</button>";a(".geo_button_cont").html(o)},t.setDefaultUserLocation=function(){if("true"===wpsl_locator.default_user_center){var o=a("[data-simple-locator-default-enabled]");t.activeFormContainer=a(o).parents("["+SimpleLocator.selectors.formContainer+"]"),t.activeForm=a(t.activeFormContainer).find("["+SimpleLocator.selectors.form+"]"),a(t.activeFormContainer).addClass("loading"),t.getLocation()}},t.setGeolocationAvailable=function(){if("true"===wpsl_locator.showgeobutton){if(a("["+SimpleLocator.selectors.formContainer+"]").removeClass("no-geolocation"),!navigator.geolocation)return!1;navigator.permissions.query({name:"geolocation"}).then(function(o){"denied"==o.state&&(t.geolocationAvailable=!1,a("["+SimpleLocator.selectors.formContainer+"]").addClass("no-geolocation")),a(document).trigger("simple-locator-geolocation-available-set",[t.geolocationAvailable])})}},t.getLocation=function(){navigator.geolocation.getCurrentPosition(function(o){var e={latitude:o.coords.latitude,longitude:o.coords.longitude};a(t.activeFormContainer).addClass("has-geolocation"),a(document).trigger("simple-locator-geolocation-success",[t.activeForm,e])},function(o){a(document).trigger("simple-locator-error",[t.activeForm,"Your location could not be determined"]),t.toggleLoading(!1)})},t.toggleLoading=function(o){if(o)return a("["+SimpleLocator.selectors.inputAddress+"]").val(""),a("["+SimpleLocator.selectors.inputLatitude+"]").val(""),a("["+SimpleLocator.selectors.inputLongitude+"]").val(""),a("["+SimpleLocator.selectors.inputGeocode+"]").val(""),a("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(""),a(t.activeFormContainer).addClass("loading"),void a(t.activeFormContainer).find("["+SimpleLocator.selectors.formError+"]").hide();a(t.activeFormContainer).removeClass("loading")},t.bindEvents()},(SimpleLocator=SimpleLocator||{}).PlacesAutocomplete=function(){var e=this,i=jQuery;return e.selectors={input:"data-simple-locator-autocomplete"},e.bindEvents=function(){i(document).ready(function(){e.enableAutocomplete()})},e.enableAutocomplete=function(){var o=i("["+e.selectors.input+"]");i.each(o,function(o,e){var t={};wpsl_locator.custom_autocomplete&&(t=wpsl_locator.autocomplete_options);var a=new google.maps.places.Autocomplete(this,t),r=(i(this).parents("["+SimpleLocator.selectors.form+"]").find("["+SimpleLocator.selectors.submitButton+"]"),i(this).parents("form"));google.maps.event.addListener(a,"place_changed",function(){i(document).trigger("simple-locator-autocomplete-changed",[a.getPlace(),r])})})},e.bindEvents()},(SimpleLocator=SimpleLocator||{}).DefaultMap=function(){var i=this,n=jQuery;return i.mapIndex,i.selectors={map:"data-simple-locator-default-enabled"},i.bindEvents=function(){n(document).ready(function(){"true"!==wpsl_locator.default_user_center&&i.queueDefaultMaps()})},i.queueDefaultMaps=function(o){var e=n("["+i.selectors.map+"]");n.each(e,function(){var o=n(this);i.setMapIndex(o),i.loadDefault(o)})},i.setMapIndex=function(o){var e=n("["+SimpleLocator.selectors.resultsWrapper+"]"),t=n(o).parents("["+SimpleLocator.selectors.resultsWrapper+"]");i.mapIndex=n(e).index(t)},i.loadDefault=function(o){var e=wpsl_locator.default_latitude,t=wpsl_locator.default_longitude;n(o).removeClass("loading");var a=new google.maps.LatLng(e,t),r={center:a,zoom:parseInt(wpsl_locator.default_zoom),styles:wpsl_locator.mapstyles};"1"===wpsl_locator.custom_map_options&&(r=wpsl_locator.map_options),r.center=a,SimpleLocator.maps[i.mapIndex]=new google.maps.Map(o[0],r)},i.bindEvents()},(SimpleLocator=SimpleLocator||{}).AllLocations=function(){var p=this,m=jQuery;return p.data,p.mapIndex,p.activeMap,p.formData={},p.paginated=!1,p.page=1,p.selectors={map:"data-simple-locator-all-locations-map",pagination:"data-simple-locator-all-results-pagination",pageJumpForm:"data-simple-locator-page-jump-form"},p.bindEvents=function(){m("["+p.selectors.map+"]").length<1||(m(document).ready(function(){p.getData()}),m(document).on("click","["+p.selectors.pagination+"] ["+SimpleLocator.selectors.paginationButton+"]",function(o){o.preventDefault(),p.paginate(m(this))}),m(document).on("submit","["+SimpleLocator.selectors.pageJumpForm+"]",function(o){var e=m(this).parents("["+SimpleLocator.selectors.resultsWrapper+"]");m(e).hasClass("non-ajax")||(o.preventDefault(),p.jumpToPage(m(this)))}))},p.setMapIndex=function(){var o=m("["+SimpleLocator.selectors.map+"]");p.mapIndex=m(p.activeMap).index(o)},p.setTaxonomyArgs=function(){var o=m(p.activeMap).data(),r={};m.each(o,function(o,e){if(0===o.indexOf("taxfilter")){var t=o.substring(9).toLowerCase(),a="number"!=typeof e?e.split(","):[e];r[t]=a}}),p.formData.taxfilter=r},p.setLimitArgs=function(){limit=m(p.activeMap).attr("data-limit"),p.formData.limit="undefined"!=typeof limit&&""!==limit?limit:"-1"},p.setPerPageArgs=function(){perpage=m(p.activeMap).attr("data-per-page"),"undefined"!=typeof perpage&&""!==perpage&&(p.formData.per_page=parseInt(perpage),p.paginated=!0)},p.setIdArgs=function(){var o=m(p.activeMap).attr("data-post-ids");void 0!==o&&""!==o&&(p.formData.ids=o)},p.setLocationArgs=function(){var o=wpsl_locator.default_latitude,e=wpsl_locator.default_longitude,t=wpsl_locator.default_enabled;if(void 0!==t&&""!==t)return void 0!==o&&""!==o?(p.formData.latitude=o,p.formData.longitude=e,void(p.formData.distance=5e3)):void(p.formData.allow_empty_address="true");p.formData.allow_empty_address="true"},p.getData=function(){var o=m("["+p.selectors.map+"]");m.each(o,function(){p.activeMap=m(this),p.setMapIndex();var o=m(this).parents("["+SimpleLocator.selectors.formContainer+"]").find("["+SimpleLocator.selectors.form+"]");void 0!==o&&""!==o&&0<o.length&&"1"!==wpsl_locator.default_enabled||(p.formData.page=p.page,p.setLocationArgs(),p.setPerPageArgs(),p.setTaxonomyArgs(),p.setLimitArgs(),p.setIdArgs(),m.ajax({url:SimpleLocator.endpoints.search,type:"GET",datatype:"json",data:p.formData,success:function(o){if(!o.results)return p.noLocations();SimpleLocator.formData[p.mapIndex]=o,SimpleLocator.formData[p.mapIndex].allLocations=!0,p.data=o,p.loadMap()},error:function(o){"1"===wpsl_locator.jsdebug&&console.log("All Locations Error")}}))})},p.loadMap=function(){SimpleLocator.markers[p.mapIndex]=[];var t=p.data.results,o=wpsl_locator.mapstyles,e=new google.maps.LatLngBounds,a={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:o,panControl:!1};"1"===wpsl_locator.custom_map_options&&(a=wpsl_locator.map_options);var r,i=new google.maps.InfoWindow;SimpleLocator.infoWindow=i;var n=new google.maps.Map(m(p.activeMap)[0],a);for(r=0;r<t.length;r++){var s=new google.maps.LatLng(t[r].latitude,t[r].longitude);e.extend(s);var l=new google.maps.Marker({position:s,map:n,title:t[r].title,icon:t[r].mappin});google.maps.event.addListener(l,"click",function(o,e){return function(){i.setContent(t[e].infowindow),i.open(n,o),m(document).trigger("simple-locator-all-locations-marker-clicked",[o,i,index]),wpsl_all_locations_marker_clicked(o,i)}}(l,r)),SimpleLocator.markers[p.mapIndex].push(l),n.fitBounds(e);var c=google.maps.event.addListener(n,"idle",function(){t.length<2&&n.setZoom(13),google.maps.event.removeListener(c)})}SimpleLocator.maps[p.mapIndex]=n,p.loadList(),m(document).trigger("simple-locator-all-locations-rendered",[n]),wpsl_all_locations_rendered(n)},p.noLocations=function(){var o=m(p.activeMap).attr("data-no-results-text");o=void 0===o||""===o?wpsl_locator.nolocationsfound:o,m("<p>"+o+"</p>").insertAfter(p.activeMap),m(p.activeMap).hide()},p.loadList=function(){var o=m(p.activeMap).attr("data-include-listing");if(void 0!==o&&"true"===o){var e=m(p.activeMap).parents("["+SimpleLocator.selectors.formContainer+"]");if(e.length<1)(t=m(p.activeMap).siblings("[data-simple-locator-results-container]")).length<1&&(t=m("<div data-simple-locator-results-container><div "+SimpleLocator.selectors.results+' class="wpsl-results"></div></div>').insertAfter(p.activeMap));else var t=m(e).find("["+SimpleLocator.selectors.results+"]");var a=m(p.activeMap).attr(p.selectors.map),r="";r+=(a=void 0!==a&&""!==a&&"true"!==a&&'<h3 class="wpsl-results-header">'+a+"</h3>")||p.data.results_header+p.data.current_counts;var n="undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options;for(n&&""!==wpsl_locator_options.resultswrapper&&(r+="<"+wpsl_locator_options.resultswrapper+">"),i=0;i<p.data.results.length;i++)r+=p.data.results[i].output;n&&""!==wpsl_locator_options.resultswrapper&&(r+="</"+wpsl_locator_options.resultswrapper+">"),p.paginated&&1<p.data.total_pages&&(r+='<div class="simple-locator-ajax-pagination" data-simple-locator-all-results-pagination>',p.data.back_button&&(r+=p.data.back_button),p.data.next_button&&(r+=p.data.next_button),p.data.loading_spinner&&(r+=p.data.loading_spinner),p.data.page_jump_form&&(r+=p.data.page_jump_form),p.data.page_position&&(r+=p.data.page_position),r+="</div>"),m(t).removeClass("loading").html(r),m(t).parents("["+SimpleLocator.selectors.formContainer+"]").removeClass("loading")}},p.paginate=function(o){if(m(o).siblings(".wpsl-icon-spinner").addClass("visible"),"next"===m(o).attr(SimpleLocator.selectors.paginationButton))return p.page=p.page+1,void p.getData();p.page=p.page-1,p.getData()},p.jumpToPage=function(o){var e=parseInt(m(o).find('input[type="tel"]').val());if(!isNaN(e)){var t=SimpleLocator.formData[p.mapIndex].total_pages;if(!(void 0!==t&&t<e)){var a=m(o).parents("["+SimpleLocator.selectors.formContainer+"]"),r=m(a).index("["+SimpleLocator.selectors.formContainer+"]");SimpleLocator.formData[r].allLocations&&(m(a).addClass("loading"),p.page=e,p.getData())}}},p.bindEvents()},(SimpleLocator=SimpleLocator||{}).Errors=function(){var a=this,r=jQuery;return a.error,a.form,a.formContainer,a.bindEvents=function(){r(document).on("simple-locator-error",function(o,e,t){a.form=e,a.formContainer=r(e).parents("["+SimpleLocator.selectors.formContainer+"]"),a.toggleError(t),r(document).trigger("simple-locator-error-message",[e,t]),a.clearMap(),wpsl_error(t,a.form)})},a.toggleError=function(o){r(a.formContainer).removeClass("loading"),r(a.formContainer).find("["+SimpleLocator.selectors.formError+"]").text(o).show()},a.clearMap=function(){var o=r("["+SimpleLocator.selectors.resultsWrapper+"]"),e=r(a.formContainer).index(o);SimpleLocator.markers[e]||(SimpleLocator.markers[e]=[]);for(var t=0;t<SimpleLocator.markers[e].length;t++)SimpleLocator.markers[e][t].setMap(null);SimpleLocator.markers[e]=[],""!==wpsl_locator.includeuserpin&&SimpleLocator.userPin[e]&&(SimpleLocator.userPin[e].setMap(null),SimpleLocator.userPin[e]=null)},a.bindEvents()},jQuery(document).ready(function(){new SimpleLocator.Factory}),(SimpleLocator=SimpleLocator||{}).selectors={resultsWrapper:"data-simple-locator-results-wrapper",form:"data-simple-locator-form",formContainer:"data-simple-locator-form-container",formError:"data-simple-locator-form-error",results:"data-simple-locator-results",map:"data-simple-locator-map",mapNonAjax:"data-simple-locator-map-non-ajax",inputAddress:"data-simple-locator-input-address",inputLatitude:"data-simple-locator-input-latitude",inputLongitude:"data-simple-locator-input-longitude",inputUnit:"data-simple-locator-input-unit",inputDistance:"data-simple-locator-input-distance",inputFormattedLocation:"data-simple-locator-input-formatted-location",inputGeocode:"data-simple-locator-input-geocode",inputLimit:"data-simple-locator-input-limit",submitButton:"data-simple-locator-submit",infoWindowLink:"data-simple-locator-open-infowindow",geoButton:"data-simple-locator-geolocation-button",ajaxForm:"data-simple-locator-ajax-form",paginationButton:"data-simple-locator-pagination",pageJumpForm:"data-simple-locator-page-jump-form"},SimpleLocator.endpoints={search:wpsl_locator.rest_url+"/search",locations:wpsl_locator.rest_url+"/locations"},SimpleLocator.maps=[],SimpleLocator.markers=[],SimpleLocator.userPin=[],SimpleLocator.formData=[],SimpleLocator.infoWindow,SimpleLocator.mapservice=wpsl_locator.mapservice,SimpleLocator.Factory=function(){jQuery;return this.init=function(){new SimpleLocator.Geocoder,new SimpleLocator.Geolocation,new SimpleLocator.PlacesAutocomplete,new SimpleLocator.DefaultMap,new SimpleLocator.ResultsMapNonAjax,new SimpleLocator.SingleLocation,new SimpleLocator.AllLocations,new SimpleLocator.Form,new SimpleLocator.ResultsMap,new SimpleLocator.ResultsList,new SimpleLocator.InfoWindowOpen,new SimpleLocator.Errors},this.init()};