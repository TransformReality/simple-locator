var SimpleLocatorAdmin;(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).DefaultMap=function(){var e=this,o=jQuery;return e.selectors={showDefaultCheckbox:"data-simple-locator-default-checkbox",defaultMap:"data-simple-locator-default-map",zoomInput:"data-simple-locator-zoom-input",latitudeInput:"data-simple-locator-latitude-input",longitudeInput:"data-simple-locator-longitude-input",locationSearchButton:"data-simple-locator-location-search-button",locationSearchInput:"data-simple-locator-location-search-input",error:"data-simple-locator-error"},e.bindEvents=function(){o(document).ready(function(){o("["+e.selectors.defaultMap+"]").length<1||wpsl_locator_defaultmap.enabled&&e.toggleDefaultMap(!0)}),o(document).on("change","["+e.selectors.showDefaultCheckbox+"]",function(){o(this).is(":checked")?e.toggleDefaultMap(!0):e.toggleDefaultMap(!1)}),o(document).on("click","["+e.selectors.locationSearchButton+"]",function(o){o.preventDefault(),e.findLocation()})},e.toggleDefaultMap=function(t){if(t)return o("["+e.selectors.defaultMap+"]").show(),void e.loadDefaultMap();o("["+e.selectors.defaultMap+"]").hide()},e.loadDefaultMap=function(t,a){t||(t=wpsl_locator_defaultmap.latitude),a||(a=wpsl_locator_defaultmap.longitude);var l=new google.maps.LatLng(t,a),n={center:l,zoom:parseInt(wpsl_locator_defaultmap.zoom),mapTypeControl:!1,streetViewControl:!1,styles:wpsl_locator_defaultmap.styles},s=new google.maps.Map(document.getElementById("wpsl-default"),n),i=new google.maps.Marker({position:l,map:s,icon:wpsl_locator_defaultmap.mappin,draggable:!0});google.maps.event.addListener(s,"zoom_changed",function(){var t=s.getZoom();o("["+e.selectors.zoomInput+"]").val(t)}),google.maps.event.addListener(i,"drag",function(){o("["+e.selectors.latitudeInput+"]").val(i.position.lat()),o("["+e.selectors.longitudeInput+"]").val(i.position.lng())})},e.findLocation=function(){e.toggleError(!1);var t=o("["+e.selectors.locationSearchInput+"]").val();geocoder=new google.maps.Geocoder,geocoder.geocode({address:t},function(o,t){if(t!=google.maps.GeocoderStatus.OK)e.toggleError(!0);else{var a=o[0].geometry.location.lat(),l=o[0].geometry.location.lng();e.loadDefaultMap(a,l)}})},e.loadSearchResults=function(t,a){e.loadDefaultMap(t,a),o("["+e.selectors.latitudeInput+"]").val(t),o("["+e.selectors.longitudeInput+"]").val(a)},e.toggleError=function(t){t?o("["+e.selectors.error+"]").show():o("["+e.selectors.error+"]").hide()},e.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).MapDisplay=function(){var e=this,o=jQuery;return e.selectors={styleChoiceSelect:"data-simple-locator-map-style-choice",styleChoice:"data-simple-locator-map-style",styleList:"data-simple-locator-map-style-list",styleSelect:"data-simple-locator-map-style-select",styleChoiceInput:"data-simple-locator-map-style-choice-input",customOptionsCheckbox:"data-simple-locator-custom-map-options-checkbox",customOptions:"data-simple-locator-custom-map-options"},e.bindEvents=function(){o(document).ready(function(){o("["+e.selectors.styleList+"]").length<1||e.buildMapChoices()}),o(document).on("change","["+e.selectors.styleChoiceSelect+"]",function(){var t=o(this).val();e.toggleChoice(t)}),o(document).on("click","["+e.selectors.styleSelect+"]",function(t){t.preventDefault(),e.selectStyle(o(this))}),o(document).on("change","["+e.selectors.customOptionsCheckbox+"]",function(){o(this).is(":checked")?o("["+e.selectors.customOptions+"]").show():o("["+e.selectors.customOptions+"]").hide()})},e.toggleChoice=function(t){t=o("["+e.selectors.styleChoice+"="+t+"]");o("["+e.selectors.styleChoice+"]").hide(),o(t).show()},e.buildMapChoices=function(){o("["+e.selectors.styleList+"]").empty(),o.each(wpsl_locator_mapstyles,function(o,t){e.buildMapHtml(o,t),e.loadChoiceMap(t)})},e.buildMapHtml=function(t,a){var l='<li class="';t%3==0&&(l+="first"),a.selected&&(l+=" active"),l+='">',l+="<h4>"+a.title+"</h4>",l+='<div class="map" id="map_'+a.id+'"></div>',l+='<a href="'+a.id+'" class="choose-style" '+e.selectors.styleSelect+">",l+="Use Style",l+="</a>",l+="</li>",o("["+e.selectors.styleList+"]").append(l)},e.loadChoiceMap=function(e){var o=JSON.parse(e.styles),t="map_"+e.id,a={center:new google.maps.LatLng(40.7699354,-73.9810812),zoom:13,mapTypeControl:!1,streetViewControl:!1,styles:o};e=new google.maps.Map(document.getElementById(t),a)},e.selectStyle=function(t){var a=o(t).attr("href");o("["+e.selectors.styleChoiceInput+"]").val(a),o("["+e.selectors.styleList+"] li").removeClass("active"),o(t).parent("li").addClass("active")},e.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).SearchHistory=function(){var e=this,o=jQuery;return e.locations,e.selectors={container:"data-simple-locator-search-history-map",perPage:"data-simple-locator-history-per-page"},e.bindEvents=function(){o(document).ready(function(){o("["+e.selectors.container+"]").length<1||(e.locations=search_history_locations,e.loadMap())}),o("["+e.selectors.perPage+"]").on("change",function(){o(this).parents("form").submit()})},e.loadMap=function(){var t,a=wpsl_locator_searchhistory.mapstyles,l=wpsl_locator_searchhistory.mappin?wpsl_locator_searchhistory.mappin:"",n=new google.maps.LatLngBounds,s=e.locations,i=o("["+e.selectors.container+"]"),c={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:a,scrollwheel:!1,panControl:!1},r=new google.maps.InfoWindow,p=new google.maps.Map(i[0],c);for(t=0;t<s.length;t++){var d=new google.maps.LatLng(s[t].latitude,s[t].longitude);n.extend(d);var m=new google.maps.Marker({position:d,map:p,title:s[t].search_term,icon:l});s[t].infowindow="<h4>"+s[t].date+"</h4>",s[t].infowindow+="<p>",s[t].infowindow+=wpsl_locator_searchhistory.searchTerm+": "+s[t].search_term,s[t].infowindow+="<br>"+wpsl_locator_searchhistory.searchTermFormatted+": "+s[t].search_term_formatted,s[t].infowindow+="<br>"+wpsl_locator_searchhistory.userIp+": "+s[t].user_ip,s[t].infowindow+="<br>"+wpsl_locator_searchhistory.distance+": "+s[t].distance,s[t].infowindow+="</p>",google.maps.event.addListener(m,"click",function(e,o){return function(){r.setContent(s[o].infowindow),r.open(p,e)}}(m,t)),p.fitBounds(n);var u=google.maps.event.addListener(p,"idle",function(){s.length<2&&p.setZoom(13),google.maps.event.removeListener(u)})}var h=google.maps.event.addListener(p,"bounds_changed",function(e){google.maps.event.removeListener(h)})},e.bindEvents()},jQuery(document).ready(function(){new SimpleLocatorAdmin.Factory}),(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).endpoints={},SimpleLocatorAdmin.Factory=function(){jQuery;return this.init=function(){new SimpleLocatorAdmin.MapDisplay,new SimpleLocatorAdmin.DefaultMap,new SimpleLocatorAdmin.SearchHistory},this.init()};