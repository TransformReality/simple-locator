var SimpleLocatorAdmin;(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).Modals=function(){var e=this,t=jQuery;return e.activeBtn="",e.activeModal="",e.modalOpen=!1,e.selectors={toggleBtn:"[data-modal-toggle]",backdrop:"[data-modal-backdrop]",closeBtn:"[data-modal-close]"},e.bindEvents=function(){t(document).on("click",e.selectors.toggleBtn,function(o){o.preventDefault(),e.activeBtn=t(this),e.openModal()}),t(document).on("click",e.selectors.closeBtn,function(t){t.preventDefault(),e.closeModals()}),t(document).on("open-modal-manual",function(o,l){e.activeModal=t('*[data-modal="'+l+'"]'),e.openModal()}),t(document).on("close-modal-manual",function(t){e.closeModals()}),t(document).on("click",e.selectors.backdrop,function(t){e.closeModals()})},e.openModal=function(){if(e.modalOpen)e.closeModals();else{if(t(e.activeBtn).length>0){var o=t(e.activeBtn).attr("data-modal-toggle");e.activeModal=t('*[data-modal="'+o+'"]')}t(e.activeModal).addClass("active"),e.modalOpen=!0,t(document).trigger("open-modal",[e.activeBtn,e.activeModal])}},e.closeModals=function(){e.modalOpen=!1,t("[data-modal]").removeClass("active"),t(document).trigger("close-modal",[e.activeBtn,e.activeModal])},e.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).GeneralSettings=function(){var e=this,t=jQuery;return e.mediaUploader=null,e.selectors={geoEnableCheckbox:"data-simple-locator-geo-enabled-checkbox",locationButtonText:"data-simple-locator-location-button-text",uploadMapPinButton:"data-simple-locator-upload-pin-button",removeMapPinButton:"data-simple-locator-remove-pin-button",mapPinImage:"data-simple-locator-map-pin-image",mapPinInput:"data-simple-locator-map-pin-input",mapPinContainer:"data-simple-locator-map-pin-image-container"},e.bindEvents=function(){t(document).ready(function(){e.toggleLocationButtonText()}),t(document).on("change","["+e.selectors.geoEnableCheckbox+"]",function(){e.toggleLocationButtonText()}),t(document).on("click","["+e.selectors.uploadMapPinButton+"]",function(o){o.preventDefault(),e.openMediaLibrary(t(this))}),t(document).on("click","["+e.selectors.removeMapPinButton+"]",function(t){t.preventDefault(),e.removeMapPin()})},e.toggleLocationButtonText=function(){var o=t("["+e.selectors.locationButtonText+"]");t("["+e.selectors.geoEnableCheckbox+"]").is(":checked")?t(o).show():t(o).hide()},e.removeMapPin=function(){t("["+e.selectors.mapPinImage+"]").remove(),t("["+e.selectors.mapPinInput+"]").val(""),t("["+e.selectors.mapPinContainer+"]").append('<input id="upload_image_button" type="button" value="'+wpsl_locator.upload+'" class="button action" '+e.selectors.uploadMapPinButton+" />"),t("["+e.selectors.removeMapPinButton+"]").remove()},e.addMapPin=function(o){var l='<img src="'+o+'" id="map-pin-image" '+e.selectors.mapPinImage+" />";l+='<input id="remove_map_pin" type="button" value="'+wpsl_locator.remove+'" class="button action" style="margin-right:5px;margin-left:10px;" '+e.selectors.removeMapPinButton+" />",t("["+e.selectors.mapPinContainer+"]").append(l),t("["+e.selectors.uploadMapPinButton+"]").remove(),t("["+e.selectors.mapPinInput+"]").val(o)},e.openMediaLibrary=function(t){e.mediaUploader?e.mediaUploader.open():(e.mediaUploader=wp.media.frames.file_frame=wp.media({title:"Choose Map Pin",button:{text:"Choose Map Pin"},multiple:!1}),e.mediaUploader.on("select",function(){var t=e.mediaUploader.state().get("selection").first().toJSON();e.addMapPin(t.url)}),e.mediaUploader.open())},e.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).PostType=function(){var e=this,t=jQuery;return e.selectors={postTypeField:"data-simple-locator-post-type-field",postTypeLabels:"data-simple-locator-post-type-labels",latitudeSelectField:"data-simple-locator-latitude-select",longitudeSelectField:"data-simple-locator-longitude-select",latitudeField:"data-simple-locator-latitude-field",longitudeField:"data-simple-locator-longitude-field",useLocatorFieldsRadio:"data-simple-locator-use-included-fields",useCustomFieldsRadio:"data-simple-locator-use-custom-fields",latLngOptions:"data-simple-locator-lat-lng-options",showHiddenCheckbox:"data-simple-locator-show-hidden",hidePostTypeCheckbox:"data-simple-locator-hide-post-type",hideIncludedFieldsCheckbox:"data-simple-locator-hide-included-fields",resetButton:"data-simple-locator-reset-post-type"},e.bindEvents=function(){t(document).ready(function(){e.togglePostTypeLabels(),e.toggleCustomFieldOptions(),e.toggleHideDefaultCheckbox(),e.toggleHideIncludedFieldsCheckbox(),e.loadPostTypeFields()}),t(document).on("change","["+e.selectors.postTypeField+"]",function(){e.togglePostTypeLabels(),e.loadPostTypeFields(),e.toggleHideDefaultCheckbox(),e.toggleHideIncludedFieldsCheckbox()}),t(document).on("change","["+e.selectors.latitudeSelectField+"],["+e.selectors.longitudeSelectField+"]",function(){e.updateLatLngValues()}),t(document).on("change","["+e.selectors.useLocatorFieldsRadio+"],["+e.selectors.useCustomFieldsRadio+"]",function(){t("["+e.selectors.useLocatorFieldsRadio+"]").is(":checked")&&e.selectLocationFields(),e.toggleCustomFieldOptions(),e.toggleHideIncludedFieldsCheckbox()}),t(document).on("change","["+e.selectors.showHiddenCheckbox+"]",function(){e.loadPostTypeFields()}),t(document).on("click","["+e.selectors.resetButton+"]",function(t){if(t.preventDefault(),!confirm("Are you sure you want to reset to the default post type?"))return!1;e.resetPostType()})},e.togglePostTypeLabels=function(){var o=t("["+e.selectors.postTypeLabels+"]");t("["+e.selectors.postTypeField+"]").val()!==wpsl_locator.posttype?t(o).hide():t(o).show()},e.loadPostTypeFields=function(){var o=t("["+e.selectors.postTypeField+"]").val();t("["+e.selectors.latitudeSelectField+"],["+e.selectors.longitudeSelectField+"]").empty(),e.getCustomFields(o)},e.selectLocationFields=function(){t("["+e.selectors.useLocatorFieldsRadio+"]").attr("checked","checked"),t("["+e.selectors.useCustomFieldsRadio+"]").removeAttr("checked"),t("["+e.selectors.latitudeField+"]").val("wpsl_latitude"),t("["+e.selectors.longitudeField+"]").val("wpsl_longitude"),t("["+e.selectors.latitudeSelectField+"]").val("wpsl_latitude"),t("["+e.selectors.longitudeSelectField+"]").val("wpsl_longitude")},e.getCustomFields=function(o){var l=t("["+e.selectors.showHidden+"]").is(":checked")?"true":"false";t.ajax({type:"GET",url:ajaxurl,data:{action:"wpslposttype",nonce:wpsl_locator.locatorNonce,post_type:o,show_hidden:l},success:function(l){t("["+e.selectors.latitudeSelectField+"],["+e.selectors.longitudeSelectField+"]").html(l.fields),e.updateLatLngValues(),"location"===o&&e.selectLocationFields()}})},e.toggleCustomFieldOptions=function(){var o=t("["+e.selectors.latLngOptions+"]");t("["+e.selectors.useCustomFieldsRadio+"]").is(":checked")?t(o).show():t(o).hide()},e.updateLatLngValues=function(){var o=t("["+e.selectors.latitudeSelectField+"]").val(),l=t("["+e.selectors.longitudeSelectField+"]").val();t("["+e.selectors.latitudeField+"]").val(o),t("["+e.selectors.longitudeField+"]").val(l)},e.toggleHideDefaultCheckbox=function(){var o=t("["+e.selectors.postTypeField+"]").val(),l=t("["+e.selectors.hidePostTypeCheckbox+"]"),a=t(l).parent("label").parent("p");if(o===wpsl_locator.posttype)return t(l).removeAttr("checked"),void t(a).hide();t(a).show()},e.toggleHideIncludedFieldsCheckbox=function(){var o=t("["+e.selectors.hideIncludedFieldsCheckbox+"]"),l=t(o).parent("label").parent("p");if(!!t("["+e.selectors.useLocatorFieldsRadio+"]").is(":checked"))return t(o).removeAttr("checked"),void t(l).hide();t(l).show()},e.resetPostType=function(){t.ajax({type:"POST",url:ajaxurl,data:{action:"wpslresetposttype"},success:function(e){location.reload()}})},e.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).PostEdit=function(){var e=this,t=jQuery;return e.lookupaddress=!0,e.mappinrelocated=!1,e.selectors={inputAddress:"#wpsl_address",inputCity:"#wpsl_city",inputState:"#wpsl_state",inputZip:"#wpsl_zip",inputLatitude:"#wpsl_latitude",inputLongitude:"#wpsl_longitude",noAddressConfirm:"data-simple-locator-confirm-no-address",publishButton:"#publish"},e.bindEvents=function(){t(window).on("load",function(){e.setMapPinStatus(),e.checkMapStatus(),"true"===t("#wpsl_custom_geo").val()&&(mappinrelocated=!0)}),t(document).on("click",".acf-tab-button",function(){e.checkMapStatus()}),t(document).on("click",e.selectors.publishButton,function(o){if(("wpsl_latitude"===wpsl_locator.lat_field||""===wpsl_locator.map_field)&&e.lookupaddress&&!e.mappinrelocated)if(o.preventDefault(),editScreenGoogleApiError)t(document).trigger("open-modal-manual",["post-edit-error"]);else{var l=e.formatAddress();e.googleGeocodeAddress(l)}}),t(document).on("click","["+e.selectors.noAddressConfirm+"]",function(t){t.preventDefault(),e.saveWithoutLocation()})},e.setMapPinStatus=function(){e.mappinrelocated="true"==t("#wpsl_custom_geo").val()},e.formatAddress=function(){return t(e.selectors.inputAddress).val()+" "+t(e.selectors.inputCity).val()+" "+t(e.selectors.inputState).val()+" "+t(e.selectors.inputZip).val()},e.googleGeocodeAddress=function(o){geocoder=new google.maps.Geocoder,geocoder.geocode({address:o},function(o,l){if(l==google.maps.GeocoderStatus.OK){var a=o[0].geometry.location.lat(),n=o[0].geometry.location.lng();t(e.selectors.inputLatitude).val(a),t(e.selectors.inputLongitude).val(n),e.lookupaddress=!1,t(e.selectors.publishButton).click()}else t(document).trigger("open-modal-manual",["post-edit-error"])})},e.saveWithoutLocation=function(){t(document).trigger("close-modal-manual"),e.lookupaddress=!1,t(e.selectors.publishButton).click()},e.checkMapStatus=function(){if(t("#wpslmap").length>0){var o=t(e.selectors.inputLatitude).val(),l=t(e.selectors.inputLongitude).val();""!==o&&""!==l&&(t("#wpslmap").show(),e.loadGoogleMap(o,l))}},e.loadGoogleMap=function(o,l){var a,n=new google.maps.Map(document.getElementById("wpslmap"),{zoom:14,center:new google.maps.LatLng(o,l),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,scaleControl:!1});a=new google.maps.Marker({position:new google.maps.LatLng(o,l),map:n,draggable:!0}),google.maps.event.addListener(a,"drag",function(){t(e.selectors.inputLatitude).val(a.position.lat()),t(e.selectors.inputLongitude).val(a.position.lng()),t(e.selectors.inputLatitude+","+e.selectors.inputLongitude).attr("readonly",!1),t("#wpsl_custom_geo").val("true"),e.mappinrelocated=!0})},e.bindEvents()},jQuery(function(e){var t=parseInt(wpsl_locator.importoffset),o=parseInt(wpsl_locator.complete_count),l=parseInt(wpsl_locator.error_count),a=!1,n=0,i=0,s=!0,c=5;function r(){e(".wpsl-loading-settings").show(),e(".wpsl-column-selection").hide(),e.ajax({url:ajaxurl,type:"POST",datatype:"json",data:{action:"wpslimportcolumns",rowcount:n,nonce:wpsl_locator.locatorNonce},success:function(t){i=t.row_count,function(t){n+1===t.row_count?e('button[data-direction="next"').attr("disabled","disabled"):e('button[data-direction="next"').attr("disabled",!1);for(var o='<option value="">'+wpsl_locator.choose_column+"</option>",l=0;l<t.columns.length;l++)o+='<option value="'+l+'">'+t.columns[l]+"</option>";e(".wpsl-import-column-selection").html(o),e(".wpsl-loading-settings").hide(),e(".wpsl-column-selection").show()}(t)}})}function d(){a||e.ajax({url:ajaxurl,type:"post",datatype:"json",data:{action:"wpsldoimport",nonce:wpsl_locator.locatorNonce,offset:t,imports_per_request:c},success:function(a){var n,i,s,c;console.log(a),"complete"===a.status?(e(".wpsl-import-indicator").hide(),e(".wpsl-import-complete").show(),e.ajax({url:ajaxurl,type:"post",datatype:"json",data:{action:"wpslfinishimport"},success:function(t){console.log(t),e(".wpsl-total-import-count").text(t.import_count),e(".wpsl-total-error-count, .error-count").text(t.error_count),t.errors.length>0&&function(t){for(var o=0;o<t.length;o++){var l="<tr><td>"+t[o].row+"</td><td>"+t[o].error+"</td></tr>";e(".wpsl-import-details table").append(l)}e(".wpsl-import-details").show()}(t.errors)}})):"error"===a.status?(e(".wpsl-import-error p").text(a.message),e(".wpsl-import-error").show()):"success"===a.status&&(o+=(n=a).import_count,t=t+n.import_count+n.failed_count,l+=n.failed_count,e(".progress-count").text(o),e(".error-count").text(l),i=e(".progress-bar-bg").width(),s=o/parseInt(e(".progress-bar-bg").data("total")),c=i*s,e(".progress-bar").width(c+"px"),d())}})}e(document).on("click",".wpsl-new-import",function(t){t.preventDefault(),e(".wpsl-upload-form").show(),e(this).parents(".wpsl-import-instructions").hide()}),e(document).on("click","[data-toggle-import-instructions]",function(t){t.preventDefault(),e(".wpsl-import-instructions").toggle()}),e(document).ready(function(){"true"===wpsl_locator.isimport&&"2"===wpsl_locator.importstep&&r()}),e(".wpsl-row-selection button").on("click",function(t){t.preventDefault(),function(t){"back"==t?n--:n++;0==n?e('button[data-direction="back"]').attr("disabled","disabled"):e('button[data-direction="back"]').attr("disabled",!1);var o=n+1,l=wpsl_locator.Row+" "+o+" of "+i;e(".wpsl-current-row").text(l),r()}(e(this).data("direction"))}),e(document).ready(function(){var t;"2"==wpsl_locator.importstep&&(t=!0,e.ajax({type:"GET",url:ajaxurl,data:{action:"wpslposttype",nonce:wpsl_locator.locatorNonce,post_type:e("#wpsl-import-post-type").val(),show_hidden:"false"},success:function(o){if(t){var l=e(".wpsl-import-field-selection");e.each(l,function(t,l){var a,n;a=e(this),n=o.fields,e(a).append('<option value="title">'+wpsl_locator.title+"</option>"),e(a).append('<option value="content">'+wpsl_locator.content+"</option>"),e(a).append(n)})}}}))}),e(".wpsl_save_columns").on("click",function(t){t.preventDefault(),e(".wpsl-column-error, .wpsl-form-error").hide(),s=!0,function(){var t=e(".wpsl-field"),o=!1,l=!1;e.each(t,function(t,a){var n=e(this).find(".wpsl-import-column-selection"),i=e(this).find(".wpsl-import-field-selection");""!==e(n).val()&&""!==e(i).val()||(e(this).find(".wpsl-column-error").text(wpsl_locator.required).show(),s=!1);var c=e(this).find(".wpsl-import-type-selection");"address"!==e(c).val()&&"full_address"!==e(c).val()||(l=!0),"title"===e(i).val()&&(o=!0)}),l||(e(".wpsl-form-error").html("<p>"+wpsl_locator.required_address+"</p>").show(),s=!1);o||(e(".wpsl-form-error").html("<p>"+wpsl_locator.required_title+"</p>").show(),s=!1)}(),s&&e(this).unbind("click").click()}),e(document).on("click",".wpsl-import-remove-field",function(t){var o,l;t.preventDefault(),o=e(this),l=e(o).parent("li"),e(l).remove()}),e(document).on("click",".wpsl-import-add-field a",function(t){var o,l;t.preventDefault(),o=e(".wpsl-field").length,l=e(".row-template").clone().removeClass("row-template"),e(l).appendTo(".wpsl-column-fields").find(".wpsl-import-remove-field").show(),e(l).find(".wpsl-column-error").text("").hide(),e(l).find(".wpsl-import-field-selection").attr("name","wpsl_import_field["+o+"][field]"),e(l).find(".wpsl-import-column-selection").attr("name","wpsl_import_field["+o+"][csv_column]"),e(l).find(".wpsl-import-type-selection").attr("name","wpsl_import_field["+o+"][type]")}),e(document).on("change",".wpsl-import-field-selection",function(){var t=e(this).val(),o=e(this).next(".wpsl-import-type-selection");"wpsl_address"===t&&e(o).val("address"),"wpsl_city"===t&&e(o).val("city"),"wpsl_state"===t&&e(o).val("state"),"wpsl_zip"===t&&e(o).val("zip"),"wpsl_website"===t&&e(o).val("website")}),e(".wpsl-start-import").on("click",function(t){t.preventDefault(),e(".wpsl-import-indicator-intro, .wpsl-last-row-imported").hide(),e(".wpsl-import-indicator").show(),d()}),e(document).on("click",".wpsl-pause-import",function(t){t.preventDefault();var o=(a=!a)?wpsl_locator.pause_continue:wpsl_locator.pause;e(this).text(o),d()}),e(document).on("click","[data-import-toggle-details]",function(t){t.preventDefault(),e(this).parents(".import").find(".import-body").toggle()}),e(document).on("click","[data-undo-import]",function(t){t.preventDefault();var o,l=e(this).attr("data-undo-import");confirm(wpsl_locator.confirm_undo)&&(o=l,e("#undo_import_id").val(o),e("[data-undo-import-form]").submit())}),e(document).on("click","[data-redo-import]",function(t){t.preventDefault();var o,l=e(this).attr("data-redo-import");confirm(wpsl_locator.confirm_redo)&&(o=l,e("#redo_import_id").val(o),e("[data-redo-import-form]").submit())}),e(document).on("click","[data-remove-import]",function(t){t.preventDefault();var o,l=e(this).attr("data-remove-import");confirm(wpsl_locator.confirm_remove)&&(o=l,e("#remove_import_id").val(o),e("[data-remove-import-form]").submit())})}),(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).DefaultMap=function(){var e=this,t=jQuery;return e.selectors={showDefaultCheckbox:"data-simple-locator-default-checkbox",defaultMap:"data-simple-locator-default-map",zoomInput:"data-simple-locator-zoom-input",latitudeInput:"data-simple-locator-latitude-input",longitudeInput:"data-simple-locator-longitude-input",locationSearchButton:"data-simple-locator-location-search-button",locationSearchInput:"data-simple-locator-location-search-input",error:"data-simple-locator-error"},e.bindEvents=function(){t(document).ready(function(){t("["+e.selectors.defaultMap+"]").length<1||wpsl_locator_defaultmap.enabled&&e.toggleDefaultMap(!0)}),t(document).on("change","["+e.selectors.showDefaultCheckbox+"]",function(){t(this).is(":checked")?e.toggleDefaultMap(!0):e.toggleDefaultMap(!1)}),t(document).on("click","["+e.selectors.locationSearchButton+"]",function(t){t.preventDefault(),e.findLocation()})},e.toggleDefaultMap=function(o){if(o)return t("["+e.selectors.defaultMap+"]").show(),void e.loadDefaultMap();t("["+e.selectors.defaultMap+"]").hide()},e.loadDefaultMap=function(o,l){o||(o=wpsl_locator_defaultmap.latitude),l||(l=wpsl_locator_defaultmap.longitude);var a=new google.maps.LatLng(o,l),n={center:a,zoom:parseInt(wpsl_locator_defaultmap.zoom),mapTypeControl:!1,streetViewControl:!1,styles:wpsl_locator_defaultmap.styles},i=new google.maps.Map(document.getElementById("wpsl-default"),n),s=new google.maps.Marker({position:a,map:i,icon:wpsl_locator_defaultmap.mappin,draggable:!0});google.maps.event.addListener(i,"zoom_changed",function(){var o=i.getZoom();t("["+e.selectors.zoomInput+"]").val(o)}),google.maps.event.addListener(s,"drag",function(){t("["+e.selectors.latitudeInput+"]").val(s.position.lat()),t("["+e.selectors.longitudeInput+"]").val(s.position.lng())})},e.findLocation=function(){e.toggleError(!1);var o=t("["+e.selectors.locationSearchInput+"]").val();geocoder=new google.maps.Geocoder,geocoder.geocode({address:o},function(t,o){if(o!=google.maps.GeocoderStatus.OK)e.toggleError(!0);else{var l=t[0].geometry.location.lat(),a=t[0].geometry.location.lng();e.loadDefaultMap(l,a)}})},e.loadSearchResults=function(o,l){e.loadDefaultMap(o,l),t("["+e.selectors.latitudeInput+"]").val(o),t("["+e.selectors.longitudeInput+"]").val(l)},e.toggleError=function(o){o?t("["+e.selectors.error+"]").show():t("["+e.selectors.error+"]").hide()},e.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).ResultsDisplay=function(){var e=this,t=jQuery;return e.bindEvents=function(){t(document).ready(function(){e.enableDatePicker()}),t(document).on("click",".wpsl-field-add",function(t){t.preventDefault(),e.addResultField()}),t(document).on("click",".wpsl-post-field-add",function(t){t.preventDefault(),e.addPostField()})},e.addResultField=function(){var e="["+t("#wpsl-fields").val()+"]";tinymce.activeEditor.execCommand("mceInsertContent",!1,e)},e.addPostField=function(){var e="["+t("#wpsl-post-fields").val()+"]";tinymce.activeEditor.execCommand("mceInsertContent",!1,e)},e.enableDatePicker=function(){t("[data-date-picker]").datepicker({beforeShow:function(e,o){t("#ui-datepicker-div").addClass("wpsl-datepicker")}})},e.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).MapDisplay=function(){var e=this,t=jQuery;return e.selectors={styleChoiceSelect:"data-simple-locator-map-style-choice",styleChoice:"data-simple-locator-map-style",styleList:"data-simple-locator-map-style-list",styleSelect:"data-simple-locator-map-style-select",styleChoiceInput:"data-simple-locator-map-style-choice-input",customOptionsCheckbox:"data-simple-locator-custom-map-options-checkbox",customOptions:"data-simple-locator-custom-map-options"},e.bindEvents=function(){t(document).ready(function(){t("["+e.selectors.styleList+"]").length<1||e.buildMapChoices()}),t(document).on("change","["+e.selectors.styleChoiceSelect+"]",function(){var o=t(this).val();e.toggleChoice(o)}),t(document).on("click","["+e.selectors.styleSelect+"]",function(o){o.preventDefault(),e.selectStyle(t(this))}),t(document).on("change","["+e.selectors.customOptionsCheckbox+"]",function(){t(this).is(":checked")?t("["+e.selectors.customOptions+"]").show():t("["+e.selectors.customOptions+"]").hide()})},e.toggleChoice=function(o){o=t("["+e.selectors.styleChoice+"="+o+"]");t("["+e.selectors.styleChoice+"]").hide(),t(o).show()},e.buildMapChoices=function(){t("["+e.selectors.styleList+"]").empty(),t.each(wpsl_locator_mapstyles,function(t,o){e.buildMapHtml(t,o),e.loadChoiceMap(o)})},e.buildMapHtml=function(o,l){var a='<li class="';o%3==0&&(a+="first"),l.selected&&(a+=" active"),a+='">',a+="<h4>"+l.title+"</h4>",a+='<div class="map" id="map_'+l.id+'"></div>',a+='<a href="'+l.id+'" class="choose-style" '+e.selectors.styleSelect+">",a+="Use Style",a+="</a>",a+="</li>",t("["+e.selectors.styleList+"]").append(a)},e.loadChoiceMap=function(e){var t=JSON.parse(e.styles),o="map_"+e.id,l={center:new google.maps.LatLng(40.7699354,-73.9810812),zoom:13,mapTypeControl:!1,streetViewControl:!1,styles:t};e=new google.maps.Map(document.getElementById(o),l)},e.selectStyle=function(o){var l=t(o).attr("href");t("["+e.selectors.styleChoiceInput+"]").val(l),t("["+e.selectors.styleList+"] li").removeClass("active"),t(o).parent("li").addClass("active")},e.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).SearchHistory=function(){var e=this,t=jQuery;return e.locations,e.selectors={container:"data-simple-locator-search-history-map",perPage:"data-simple-locator-history-per-page"},e.bindEvents=function(){t(document).ready(function(){t("["+e.selectors.container+"]").length<1||(e.locations=search_history_locations,e.loadMap())}),t("["+e.selectors.perPage+"]").on("change",function(){t(this).parents("form").submit()})},e.loadMap=function(){var o,l=wpsl_locator_searchhistory.mapstyles,a=wpsl_locator_searchhistory.mappin?wpsl_locator_searchhistory.mappin:"",n=new google.maps.LatLngBounds,i=e.locations,s=t("["+e.selectors.container+"]"),c={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:l,scrollwheel:!1,panControl:!1},r=new google.maps.InfoWindow,d=new google.maps.Map(s[0],c);for(o=0;o<i.length;o++){var p=new google.maps.LatLng(i[o].latitude,i[o].longitude);n.extend(p);var u=new google.maps.Marker({position:p,map:d,title:i[o].search_term,icon:a});i[o].infowindow="<h4>"+i[o].date+"</h4>",i[o].infowindow+="<p>",i[o].infowindow+=wpsl_locator_searchhistory.searchTerm+": "+i[o].search_term,i[o].infowindow+="<br>"+wpsl_locator_searchhistory.searchTermFormatted+": "+i[o].search_term_formatted,i[o].infowindow+="<br>"+wpsl_locator_searchhistory.userIp+": "+i[o].user_ip,i[o].infowindow+="<br>"+wpsl_locator_searchhistory.distance+": "+i[o].distance,i[o].infowindow+="</p>",google.maps.event.addListener(u,"click",function(e,t){return function(){r.setContent(i[t].infowindow),r.open(d,e)}}(u,o)),d.fitBounds(n);var m=google.maps.event.addListener(d,"idle",function(){i.length<2&&d.setZoom(13),google.maps.event.removeListener(m)})}var f=google.maps.event.addListener(d,"bounds_changed",function(e){google.maps.event.removeListener(f)})},e.bindEvents()},jQuery(document).ready(function(){new SimpleLocatorAdmin.Factory}),(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).endpoints={},SimpleLocatorAdmin.Factory=function(){jQuery;return this.init=function(){new SimpleLocatorAdmin.Modals,new SimpleLocatorAdmin.PostEdit,new SimpleLocatorAdmin.GeneralSettings,new SimpleLocatorAdmin.PostType,new SimpleLocatorAdmin.MapDisplay,new SimpleLocatorAdmin.ResultsDisplay,new SimpleLocatorAdmin.DefaultMap,new SimpleLocatorAdmin.SearchHistory},this.init()};var editScreenGoogleApiError=!1;function gm_authFailure(e){editScreenGoogleApiError=!0}