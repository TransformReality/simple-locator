var SimpleLocatorAdmin;(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).Modals=function(){var o=this,l=jQuery;return o.activeBtn="",o.activeModal="",o.modalOpen=!1,o.selectors={toggleBtn:"[data-wpsl-modal-toggle]",backdrop:"[data-wpsl-modal-backdrop]",closeBtn:"[data-wpsl-modal-close]"},o.bindEvents=function(){l(document).on("click",o.selectors.toggleBtn,function(e){e.preventDefault(),o.activeBtn=l(this),o.openModal()}),l(document).on("click",o.selectors.closeBtn,function(e){e.preventDefault(),o.closeModals()}),l(document).on("open-wpsl-modal-manual",function(e,t){o.activeModal=l('*[data-wpsl-modal="'+t+'"]'),console.log(o.activeModal),o.openModal()}),l(document).on("close-wpsl-modal-manual",function(e){o.closeModals()}),l(document).on("click",o.selectors.backdrop,function(e){o.closeModals()})},o.openModal=function(){if(o.modalOpen)o.closeModals();else{if(0<l(o.activeBtn).length){var e=l(o.activeBtn).attr("data-wpsl-modal-toggle");o.activeModal=l('*[data-wpsl-modal="'+e+'"]')}l(o.activeModal).addClass("active"),o.modalOpen=!0,l(document).trigger("open-wpsl-modal",[o.activeBtn,o.activeModal])}},o.closeModals=function(){o.modalOpen=!1,l("[data-wpsl-modal]").removeClass("active"),l(document).trigger("close-wpsl-modal",[o.activeBtn,o.activeModal])},o.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).GeneralSettings=function(){var n=this,i=jQuery;return n.selectors={geoEnableCheckbox:"data-simple-locator-geo-enabled-checkbox",locationButtonText:"data-simple-locator-location-button-text",uploadMapPinButton:"data-simple-locator-upload-pin-button",removeMapPinButton:"data-simple-locator-remove-pin-button",mapPinImage:"data-simple-locator-map-pin-image",mapPinInput:"data-simple-locator-map-pin-input",mapPinContainer:"data-simple-locator-map-pin-image-container",userMapPin:"data-simple-locator-user-map-pin",userPinCheckbox:"data-simple-locator-toggle-user-pin"},n.bindEvents=function(){i(document).ready(function(){n.toggleLocationButtonText(),n.toggleUserPin()}),i(document).on("change","["+n.selectors.geoEnableCheckbox+"]",function(){n.toggleLocationButtonText()}),i(document).on("click","["+n.selectors.uploadMapPinButton+"]",function(e){e.preventDefault(),n.openMediaLibrary(i(this))}),i(document).on("click","["+n.selectors.removeMapPinButton+"]",function(e){e.preventDefault(),n.removeMapPin(i(this))}),i(document).on("change","["+n.selectors.userPinCheckbox+"]",function(){n.toggleUserPin()})},n.toggleLocationButtonText=function(){var e=i("["+n.selectors.locationButtonText+"]");if(i("["+n.selectors.geoEnableCheckbox+"]").is(":checked"))return"https:"!==location.protocol&&i("[data-simple-locator-no-https]").show(),void i(e).show();i("[data-simple-locator-no-https]").hide(),i(e).hide()},n.removeMapPin=function(e){var t=i(e).parent(".field"),o=i(t).find("["+n.selectors.mapPinInput+"]");i(t).find("["+n.selectors.mapPinContainer+"]").html(""),i(t).find("["+n.selectors.mapPinInput+"]").val("");var l='<input id="upload_image_button" type="button" value="'+wpsl_locator.upload+'" class="button action" '+n.selectors.uploadMapPinButton+" />";i(l).insertBefore(o),i(t).find("["+n.selectors.removeMapPinButton+"]").remove()},n.addMapPin=function(e,t){var o=i(t).parent(".field"),l='<img src="'+e+'" id="map-pin-image" '+n.selectors.mapPinImage+" />",s='<input type="button" value="'+wpsl_locator.remove+'" class="button action" style="margin-right:5px;margin-left:10px;" '+n.selectors.removeMapPinButton+" />";i(o).find("["+n.selectors.mapPinContainer+"]").html(l);var a=i(o).find("["+n.selectors.mapPinInput+"]");i(s).insertBefore(a),i(o).find("["+n.selectors.uploadMapPinButton+"]").remove(),i(o).find("["+n.selectors.mapPinInput+"]").val(e)},n.openMediaLibrary=function(t){mediaUploader=wp.media.frames.file_frame=wp.media({title:"Choose Map Pin",button:{text:"Choose Map Pin"},multiple:!1}),mediaUploader.on("select",function(){var e=mediaUploader.state().get("selection").first().toJSON();n.addMapPin(e.url,t)}),mediaUploader.open()},n.toggleUserPin=function(){i("["+n.selectors.userPinCheckbox+"]").is(":checked")?i("["+n.selectors.userMapPin+"]").show():i("["+n.selectors.userMapPin+"]").hide()},n.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).PostType=function(){var l=this,s=jQuery;return l.selectors={postTypeField:"data-simple-locator-post-type-field",postTypeLabels:"data-simple-locator-post-type-labels",latitudeSelectField:"data-simple-locator-latitude-select",longitudeSelectField:"data-simple-locator-longitude-select",latitudeField:"data-simple-locator-latitude-field",longitudeField:"data-simple-locator-longitude-field",useLocatorFieldsRadio:"data-simple-locator-use-included-fields",useCustomFieldsRadio:"data-simple-locator-use-custom-fields",latLngOptions:"data-simple-locator-lat-lng-options",showHiddenCheckbox:"data-simple-locator-show-hidden",hidePostTypeCheckbox:"data-simple-locator-hide-post-type",hideIncludedFieldsCheckbox:"data-simple-locator-hide-included-fields",resetButton:"data-simple-locator-reset-post-type",resetButtonCheckbox:"data-simple-locator-resest-post-type-checkbox",acfMapField:"data-simple-locator-acf-map-field"},l.bindEvents=function(){s(document).ready(function(){l.togglePostTypeLabels(),l.toggleCustomFieldOptions(),l.toggleHideDefaultCheckbox(),l.toggleHideIncludedFieldsCheckbox(),l.loadPostTypeFields(),l.toggleAcfMapField()}),s(document).on("change","["+l.selectors.postTypeField+"]",function(){l.togglePostTypeLabels(),l.loadPostTypeFields(),l.toggleHideDefaultCheckbox(),l.toggleHideIncludedFieldsCheckbox()}),s(document).on("change","["+l.selectors.latitudeSelectField+"],["+l.selectors.longitudeSelectField+"]",function(){l.updateLatLngValues()}),s(document).on("change","["+l.selectors.useLocatorFieldsRadio+"],["+l.selectors.useCustomFieldsRadio+"]",function(){s("["+l.selectors.useLocatorFieldsRadio+"]").is(":checked")&&l.selectLocationFields(),l.toggleAcfMapField(),l.toggleCustomFieldOptions(),l.toggleHideIncludedFieldsCheckbox()}),s(document).on("change","["+l.selectors.showHiddenCheckbox+"]",function(){l.loadPostTypeFields()}),s(document).on("click","["+l.selectors.resetButton+"]",function(e){if(e.preventDefault(),!confirm("Are you sure you want to reset to the default post type?"))return!1;l.resetPostType()}),s(document).on("change","["+l.selectors.resetButtonCheckbox+"]",function(){var e=s("["+l.selectors.resetButton+"]");s(this).is(":checked")?s(e).show():s(e).hide()})},l.togglePostTypeLabels=function(){var e=s("["+l.selectors.postTypeLabels+"]");s("["+l.selectors.postTypeField+"]").val()!==wpsl_locator.posttype?s(e).hide():s(e).show()},l.loadPostTypeFields=function(){var e=s("["+l.selectors.postTypeField+"]").val();s("["+l.selectors.useLocatorFieldsRadio+"]").is(":checked")?l.selectLocationFields():(s("["+l.selectors.latitudeSelectField+"],["+l.selectors.longitudeSelectField+"]").empty(),l.getCustomFields(e))},l.selectLocationFields=function(){s("["+l.selectors.useLocatorFieldsRadio+"]").attr("checked","checked"),s("["+l.selectors.useCustomFieldsRadio+"]").removeAttr("checked"),s("["+l.selectors.latitudeField+"]").val("wpsl_latitude"),s("["+l.selectors.longitudeField+"]").val("wpsl_longitude"),s("["+l.selectors.latitudeSelectField+"]").val("wpsl_latitude"),s("["+l.selectors.longitudeSelectField+"]").val("wpsl_longitude")},l.getCustomFields=function(t){var e=s("["+l.selectors.showHidden+"]").is(":checked")?"true":"false",o=s("["+l.selectors.useLocatorFieldsRadio+"]").is(":checked")?"true":"false";s.ajax({type:"GET",url:ajaxurl,data:{action:"wpslposttype",nonce:wpsl_locator.locatorNonce,post_type:t,show_hidden:e,include_wpsl:o},success:function(e){s("["+l.selectors.latitudeSelectField+"],["+l.selectors.longitudeSelectField+"]").html(e.fields),l.updateLatLngValues(),"location"===t&&l.selectLocationFields()}})},l.toggleCustomFieldOptions=function(){var e=s("["+l.selectors.latLngOptions+"]");s("["+l.selectors.useCustomFieldsRadio+"]").is(":checked")?s(e).show():s(e).hide()},l.updateLatLngValues=function(){var e=s("["+l.selectors.latitudeSelectField+"]").val(),t=s("["+l.selectors.longitudeSelectField+"]").val();s("["+l.selectors.latitudeField+"]").val(e),s("["+l.selectors.longitudeField+"]").val(t)},l.toggleHideDefaultCheckbox=function(){var e=s("["+l.selectors.postTypeField+"]").val(),t=s("["+l.selectors.hidePostTypeCheckbox+"]"),o=s(t).parents(".row");if(e===wpsl_locator.posttype)return s(t).removeAttr("checked"),void s(o).hide();s(o).show()},l.toggleHideIncludedFieldsCheckbox=function(){var e=s("["+l.selectors.hideIncludedFieldsCheckbox+"]"),t=s(e).parent("label").parent("p");if(!!s("["+l.selectors.useLocatorFieldsRadio+"]").is(":checked"))return s(e).removeAttr("checked"),void s(t).hide();s(t).show()},l.resetPostType=function(){s.ajax({type:"POST",url:ajaxurl,data:{action:"wpslresetposttype"},success:function(e){location.reload()}})},l.toggleAcfMapField=function(){s("["+l.selectors.useLocatorFieldsRadio+"]").is(":checked")?s("["+l.selectors.acfMapField+"]").hide():s("["+l.selectors.acfMapField+"]").show()},l.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).PostEdit=function(){var s=this,a=jQuery;return s.lookupaddress=!0,s.mappinrelocated=!1,s.selectors={inputAddress:"#wpsl_address",inputCity:"#wpsl_city",inputState:"#wpsl_state",inputZip:"#wpsl_zip",inputLatitude:"#wpsl_latitude",inputLongitude:"#wpsl_longitude",noAddressConfirm:"data-simple-locator-confirm-no-address",publishButton:"#publish"},s.bindEvents=function(){a(window).on("load",function(){s.setMapPinStatus(),s.checkMapStatus(),"true"===a("#wpsl_custom_geo").val()&&(mappinrelocated=!0)}),a(document).on("click",".acf-tab-button",function(){s.checkMapStatus()}),a(document).on("click",s.selectors.publishButton,function(e){if(("wpsl_latitude"===wpsl_locator.lat_field||""===wpsl_locator.map_field)&&s.lookupaddress&&!s.mappinrelocated)if(e.preventDefault(),editScreenGoogleApiError)a(document).trigger("open-wpsl-modal-manual",["post-edit-error"]);else{var t=s.formatAddress();s.googleGeocodeAddress(t)}}),a(document).on("click","["+s.selectors.noAddressConfirm+"]",function(e){e.preventDefault(),s.saveWithoutLocation()})},s.setMapPinStatus=function(){s.mappinrelocated="true"==a("#wpsl_custom_geo").val()},s.formatAddress=function(){return a(s.selectors.inputAddress).val()+" "+a(s.selectors.inputCity).val()+" "+a(s.selectors.inputState).val()+" "+a(s.selectors.inputZip).val()},s.googleGeocodeAddress=function(e){geocoder=new google.maps.Geocoder,geocoder.geocode({address:e},function(e,t){if(t==google.maps.GeocoderStatus.OK){var o=e[0].geometry.location.lat(),l=e[0].geometry.location.lng();a(s.selectors.inputLatitude).val(o),a(s.selectors.inputLongitude).val(l),s.lookupaddress=!1,a(s.selectors.publishButton).click()}else a(document).trigger("open-wpsl-modal-manual",["post-edit-error"])})},s.saveWithoutLocation=function(){a(document).trigger("close-wpsl-modal-manual"),s.lookupaddress=!1,a(s.selectors.publishButton).click()},s.checkMapStatus=function(){if(0<a("#wpslmap").length){var e=a(s.selectors.inputLatitude).val(),t=a(s.selectors.inputLongitude).val();""!==e&&""!==t&&(a("#wpslmap").show(),s.loadGoogleMap(e,t))}},s.loadGoogleMap=function(e,t){var o,l=new google.maps.Map(document.getElementById("wpslmap"),{zoom:14,center:new google.maps.LatLng(e,t),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,scaleControl:!1});o=new google.maps.Marker({position:new google.maps.LatLng(e,t),map:l,draggable:!0}),google.maps.event.addListener(o,"drag",function(){a(s.selectors.inputLatitude).val(o.position.lat()),a(s.selectors.inputLongitude).val(o.position.lng()),a(s.selectors.inputLatitude+","+s.selectors.inputLongitude).attr("readonly",!1),a("#wpsl_custom_geo").val("true"),s.mappinrelocated=!0})},s.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).DefaultMap=function(){var n=this,i=jQuery;return n.selectors={showDefaultCheckbox:"data-simple-locator-default-checkbox",defaultMap:"data-simple-locator-default-map",defaultMapContainer:"data-simple-locator-default-map-container",zoomInput:"data-simple-locator-default-map-zoom",latitudeInput:"data-simple-locator-default-map-latitude",longitudeInput:"data-simple-locator-default-map-longitude",locationSearchButton:"data-simple-locator-location-search-button",locationSearchInput:"data-simple-locator-location-search-input",error:"data-simple-locator-error",centerUserPositionCheckbox:"data-simple-locator-user-position-default"},n.bindEvents=function(){i(document).ready(function(){i("["+n.selectors.defaultMap+"]").length<1||(n.toggleDefaultMap(),n.toggleHttpsWarning())}),i(document).on("change","["+n.selectors.showDefaultCheckbox+"]",function(){n.toggleDefaultMap()}),i(document).on("click","["+n.selectors.locationSearchButton+"]",function(e){e.preventDefault(),n.findLocation()}),i(document).on("change","["+n.selectors.centerUserPositionCheckbox+"]",function(){n.toggleHttpsWarning()})},n.toggleDefaultMap=function(){var e=i("["+n.selectors.showDefaultCheckbox+"]").is(":checked"),t=i("["+n.selectors.defaultMapContainer+"]");if(e)return i(t).show(),void n.loadDefaultMap();i(t).hide()},n.loadDefaultMap=function(e,t){t=void 0!==(e=void 0!==e&&""!==e&&e)&&""!==t&&t,e||(e=wpsl_locator_defaultmap.latitude),t||(t=wpsl_locator_defaultmap.longitude);var o=new google.maps.LatLng(e,t),l={center:o,zoom:parseInt(wpsl_locator_defaultmap.zoom),mapTypeControl:!1,streetViewControl:!1,styles:wpsl_locator_defaultmap.styles},s=new google.maps.Map(document.getElementById("wpsl-default"),l),a=new google.maps.Marker({position:o,map:s,icon:wpsl_locator_defaultmap.mappin,draggable:!0});e&&t&&(i("["+n.selectors.latitudeInput+"]").val(e),i("["+n.selectors.longitudeInput+"]").val(t)),google.maps.event.addListener(s,"zoom_changed",function(){var e=s.getZoom();i("["+n.selectors.zoomInput+"]").val(e)}),google.maps.event.addListener(a,"drag",function(){i("["+n.selectors.latitudeInput+"]").val(a.position.lat()),i("["+n.selectors.longitudeInput+"]").val(a.position.lng())})},n.findLocation=function(){n.toggleError(!1);var e=i("["+n.selectors.locationSearchInput+"]").val();geocoder=new google.maps.Geocoder,geocoder.geocode({address:e},function(e,t){if(t!=google.maps.GeocoderStatus.OK)n.toggleError(!0);else{var o=e[0].geometry.location.lat(),l=e[0].geometry.location.lng();n.loadDefaultMap(o,l)}})},n.loadSearchResults=function(e,t){n.loadDefaultMap(e,t)},n.toggleError=function(e){e?i("["+n.selectors.error+"]").show():i("["+n.selectors.error+"]").hide()},n.toggleHttpsWarning=function(){i("["+n.selectors.centerUserPositionCheckbox+"]").is(":checked")?"https:"!==location.protocol&&i("[data-simple-locator-no-https]").show():i("[data-simple-locator-no-https]").hide()},n.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).ResultsDisplay=function(){var t=this,o=jQuery;return t.bindEvents=function(){o(document).ready(function(){t.enableDatePicker()}),o(document).on("click",".wpsl-field-add",function(e){e.preventDefault(),t.addResultField()}),o(document).on("click",".wpsl-post-field-add",function(e){e.preventDefault(),t.addPostField()})},t.addResultField=function(){var e="["+o("#wpsl-fields").val()+"]";tinymce.activeEditor.execCommand("mceInsertContent",!1,e)},t.addPostField=function(){var e="["+o("#wpsl-post-fields").val()+"]";tinymce.activeEditor.execCommand("mceInsertContent",!1,e)},t.enableDatePicker=function(){o("[data-date-picker]").datepicker({beforeShow:function(e,t){o("#ui-datepicker-div").addClass("wpsl-datepicker")}})},t.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).MapDisplay=function(){var l=this,s=jQuery;return l.selectors={styleChoiceSelect:"data-simple-locator-map-style-choice",styleChoice:"data-simple-locator-map-style",styleList:"data-simple-locator-map-style-list",styleSelect:"data-simple-locator-map-style-select",styleChoiceInput:"data-simple-locator-map-style-choice-input",customOptionsCheckbox:"data-simple-locator-custom-map-options-checkbox",customOptions:"data-simple-locator-custom-map-options",customAutocompleteCheckbox:"data-simple-locator-custom-autocomplete-option",customAutocomplete:"data-simple-locator-custom-autocomplete"},l.bindEvents=function(){s(document).ready(function(){s("["+l.selectors.styleList+"]").length<1||l.buildMapChoices()}),s(document).on("change","["+l.selectors.styleChoiceSelect+"]",function(){var e=s(this).val();l.toggleChoice(e)}),s(document).on("click","["+l.selectors.styleSelect+"]",function(e){e.preventDefault(),l.selectStyle(s(this))}),s(document).on("change","["+l.selectors.customOptionsCheckbox+"]",function(){s(this).is(":checked")?s("["+l.selectors.customOptions+"]").show():s("["+l.selectors.customOptions+"]").hide()}),s(document).on("change","["+l.selectors.customAutocompleteCheckbox+"]",function(){l.toggleAutocompleteOptions()})},l.toggleChoice=function(e){e=s("["+l.selectors.styleChoice+"="+e+"]");s("["+l.selectors.styleChoice+"]").hide(),s(e).show()},l.buildMapChoices=function(){s("["+l.selectors.styleList+"]").empty(),s.each(wpsl_locator_mapstyles,function(e,t){l.buildMapHtml(e,t),l.loadChoiceMap(t)})},l.buildMapHtml=function(e,t){var o='<li class="';e%3==0&&(o+="first"),t.selected&&(o+=" active"),o+='">',o+="<h4>"+t.title+"</h4>",o+='<div class="map" id="map_'+t.id+'"></div>',o+='<a href="'+t.id+'" class="choose-style" '+l.selectors.styleSelect+">",o+="Use Style",o+="</a>",o+="</li>",s("["+l.selectors.styleList+"]").append(o)},l.loadChoiceMap=function(e){var t=JSON.parse(e.styles),o="map_"+e.id,l={center:new google.maps.LatLng(40.7699354,-73.9810812),zoom:13,mapTypeControl:!1,streetViewControl:!1,styles:t};e=new google.maps.Map(document.getElementById(o),l)},l.selectStyle=function(e){var t=s(e).attr("href");s("["+l.selectors.styleChoiceInput+"]").val(t),s("["+l.selectors.styleList+"] li").removeClass("active"),s(e).parent("li").addClass("active")},l.toggleAutocompleteOptions=function(){s("["+l.selectors.customAutocompleteCheckbox+"]").is(":checked")?s("["+l.selectors.customAutocomplete+"]").show():s("["+l.selectors.customAutocomplete+"]").hide()},l.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).SearchHistory=function(){var m=this,g=jQuery;return m.locations,m.selectors={container:"data-simple-locator-search-history-map",perPage:"data-simple-locator-history-per-page"},m.bindEvents=function(){g(document).ready(function(){g("["+m.selectors.container+"]").length<1||(m.locations=search_history_locations,m.loadMap())}),g("["+m.selectors.perPage+"]").on("change",function(){g(this).parents("form").submit()})},m.loadMap=function(){var e,t=wpsl_locator_searchhistory.mapstyles,o=wpsl_locator_searchhistory.mappin?wpsl_locator_searchhistory.mappin:"",l=new google.maps.LatLngBounds,s=m.locations,a=g("["+m.selectors.container+"]"),n={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:t,scrollwheel:!1,panControl:!1},i=new google.maps.InfoWindow,r=new google.maps.Map(a[0],n);for(e=0;e<s.length;e++){var c=new google.maps.LatLng(s[e].latitude,s[e].longitude);l.extend(c);var p=new google.maps.Marker({position:c,map:r,title:s[e].search_term,icon:o});s[e].infowindow="<h4>"+s[e].date+"</h4>",s[e].infowindow+="<p>",s[e].infowindow+=wpsl_locator_searchhistory.searchTerm+": "+s[e].search_term,s[e].infowindow+="<br>"+wpsl_locator_searchhistory.searchTermFormatted+": "+s[e].search_term_formatted,s[e].infowindow+="<br>"+wpsl_locator_searchhistory.userIp+": "+s[e].user_ip,s[e].infowindow+="<br>"+wpsl_locator_searchhistory.distance+": "+s[e].distance,s[e].infowindow+="</p>",google.maps.event.addListener(p,"click",function(e,t){return function(){i.setContent(s[t].infowindow),i.open(r,e)}}(p,e)),r.fitBounds(l);var d=google.maps.event.addListener(r,"idle",function(){s.length<2&&r.setZoom(13),google.maps.event.removeListener(d)})}var u=google.maps.event.addListener(r,"bounds_changed",function(e){google.maps.event.removeListener(u)})},m.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).ImportUpload=function(){var o=this,l=jQuery;return o.selectors={startNewBtn:"data-simple-locator-import-start-new",uploadForm:"data-simple-locator-import-upload-form",previousImportMessage:"data-simple-locator-import-previous-message",postTypeInput:"data-simple-locator-import-post-type-input",toggleHiddenPostTypeCheckbox:"data-simple-locator-show-non-public-types",nonPublicPostType:"data-non-public-post-type",toggleImportDetails:"data-import-toggle-details",undoImportButton:"data-simple-locator-import-undo-button",redoImportButton:"data-simple-locator-import-redo-button",removeImportButton:"data-simple-locator-import-remove-button"},o.bindEvents=function(){l(document).ready(function(){o.togglePublicPostTypes()}),l(document).on("change","["+o.selectors.toggleHiddenPostTypeCheckbox+"]",function(){o.togglePublicPostTypes()}),l(document).on("click","["+o.selectors.startNewBtn+"]",function(e){e.preventDefault(),o.startNewImport()}),l(document).on("click","["+o.selectors.toggleImportDetails+"]",function(e){e.preventDefault(),o.toggleImportDetails(l(this))}),l(document).on("click","["+o.selectors.undoImportButton+"]",function(e){e.preventDefault();var t=l(this).attr(o.selectors.undoImportButton);o.undoImport(t)}),l(document).on("click","["+o.selectors.redoImportButton+"]",function(e){e.preventDefault();var t=l(this).attr(o.selectors.redoImportButton);o.redoImport(t)}),l(document).on("click","["+o.selectors.removeImportButton+"]",function(e){e.preventDefault();var t=l(this).attr(o.selectors.removeImportButton);o.removeImport(t)})},o.startNewImport=function(){l("["+o.selectors.uploadForm+"]").show(),l("["+o.selectors.previousImportMessage+"]").hide()},o.togglePublicPostTypes=function(){var e=l("["+o.selectors.nonPublicPostType+"]");l("["+o.selectors.toggleHiddenPostTypeCheckbox+"]").is(":checked")?l(e).show():l(e).hide()},o.toggleImportDetails=function(e){l(e).parents(".import").find(".import-body").toggle()},o.undoImport=function(e){confirm(wpsl_locator.confirm_undo)&&(l("#undo_import_id").val(e),l("[data-undo-import-form]").submit())},o.redoImport=function(e){confirm(wpsl_locator.confirm_redo)&&(l("#redo_import_id").val(e),l("[data-redo-import-form]").submit())},o.removeImport=function(e){confirm(wpsl_locator.confirm_remove)&&(l("#remove_import_id").val(e),l("[data-remove-import-form]").submit())},o.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).ImportColumnMap=function(){var r=this,c=jQuery;return r.totalrows=0,r.rowcount=0,r.selectors={loadingIndicator:"data-simple-locator-import-loading",columnSelection:"data-simple-locator-import-column-selection",rowSelectionButton:"data-simple-locator-import-row-selection-button",rowSelectionButtonNext:'[data-simple-locator-import-row-selection-button="next"]',rowSelectionButtonBack:'[data-simple-locator-import-row-selection-button="back"]',currentRowText:"data-simple-locator-import-current-row",postType:"data-simple-locator-import-post-type",selectColumn:"data-simple-locator-import-column-select",selectField:"data-simple-locator-import-field-select",selectType:"data-simple-locator-import-type-select",addFieldButton:"data-simple-locator-import-add-field",removeFieldButton:"data-simple-locator-import-remove-field",saveButton:"data-simple-locator-import-save",formError:"data-simple-locator-form-error",columnError:"data-simple-locator-column-error",fieldRow:"data-simple-locator-import-field",form:"data-simple-locator-import-column-form"},r.bindEvents=function(){c(document).ready(function(){"true"===wpsl_locator.isimport&&"2"===wpsl_locator.importstep&&(r.getColumns(),r.getPostTypeFields())}),c("["+r.selectors.rowSelectionButton+"]").on("click",function(e){e.preventDefault(),r.moveRowSelection(c(this))}),c(document).on("change","["+r.selectors.selectField+"]",function(){r.autoSelectFieldType(c(this))}),c(document).on("click","["+r.selectors.addFieldButton+"]",function(e){e.preventDefault(),r.addField()}),c(document).on("click","["+r.selectors.removeFieldButton+"]",function(e){e.preventDefault(),r.removeField(c(this))}),c(document).on("click","["+r.selectors.saveButton+"]",function(e){e.preventDefault(),c("["+r.selectors.formError+"],["+r.selectors.columnError+"]").hide(),r.validates()&&c("["+r.selectors.form+"]").submit()})},r.getColumns=function(){r.toggleLoading(!0),c.ajax({url:ajaxurl,type:"POST",datatype:"json",data:{action:"wpslimportcolumns",rowcount:r.rowcount,nonce:wpsl_locator.locatorNonce},success:function(e){r.totalrows=e.row_count,r.updateCurrentRowText(),r.populateColumnSelects(e)}})},r.populateColumnSelects=function(e){var t=r.rowcount+1===e.row_count&&"disabled";c(r.selectors.rowSelectionButtonNext).attr("disabled",t);for(var o='<option value="">'+wpsl_locator.choose_column+"</option>",l=0;l<e.columns.length;l++)o+='<option value="'+l+'">'+e.columns[l]+"</option>";c("["+r.selectors.selectColumn+"]").html(o),r.toggleLoading(!1)},r.moveRowSelection=function(e){r.rowcount="next"===c(e).attr(r.selectors.rowSelectionButton)?r.rowcount+1:r.rowcount-1;var t=0==r.rowcount&&"disabled";c(r.selectors.rowSelectionButtonBack).attr("disabled",t),r.getColumns()},r.updateCurrentRowText=function(){var e=wpsl_locator.Row+" "+(r.rowcount+1)+" of "+r.totalrows;c("["+r.selectors.currentRowText+"]").text(e)},r.getPostTypeFields=function(){c.ajax({type:"GET",url:ajaxurl,data:{action:"wpslposttype",nonce:wpsl_locator.locatorNonce,post_type:c("["+r.selectors.postType+"]").val(),show_hidden:"false",include_wpsl:"true"},success:function(e){r.populateWordPressFieldSelects(e)}})},r.populateWordPressFieldSelects=function(o){var e=c("["+r.selectors.selectField+"]");c.each(e,function(e,t){c(this).append('<option value="title">'+wpsl_locator.title+"</option>"),c(this).append('<option value="content">'+wpsl_locator.content+"</option>"),c(this).append(o.fields)})},r.autoSelectFieldType=function(e){var t=c(e).val(),o=c(e).next("["+r.selectors.selectType+"]");"wpsl_address"===t&&c(o).val("address"),"wpsl_city"===t&&c(o).val("city"),"wpsl_state"===t&&c(o).val("state"),"wpsl_zip"===t&&c(o).val("zip"),"wpsl_website"===t&&c(o).val("website")},r.addField=function(){var e=c(".wpsl-field").length,t=c(".row-template").clone().removeClass("row-template");c(t).appendTo(".wpsl-column-fields").find("["+r.selectors.removeFieldButton+"]").show(),c(t).find(".wpsl-column-error").text("").hide(),c(t).find("["+r.selectors.selectField+"]").attr("name","wpsl_import_field["+e+"][field]"),c(t).find("["+r.selectors.selectColumn+"]").attr("name","wpsl_import_field["+e+"][csv_column]"),c(t).find("["+r.selectors.selectType+"]").attr("name","wpsl_import_field["+e+"][type]")},r.removeField=function(e){var t=c(e).parent("li");c(t).remove()},r.validates=function(){var a=!1,n=!1,i=!0;return c.each(c("["+r.selectors.fieldRow+"]"),function(e,t){var o=c(this).find("["+r.selectors.selectColumn+"]"),l=c(this).find("["+r.selectors.selectField+"]");""!==c(o).val()&&""!==c(l).val()||(c(this).find("["+r.selectors.columnError+"]").text(wpsl_locator.required).show(),i=!1);var s=c(this).find("["+r.selectors.selectType+"]");"address"!==c(s).val()&&"full_address"!==c(s).val()||(n=!0),"title"===c(l).val()&&(a=!0)}),n||(c("["+r.selectors.formError+"]").html("<p>"+wpsl_locator.required_address+"</p>").show(),i=!1),a||(c("["+r.selectors.formError+"]").html("<p>"+wpsl_locator.required_title+"</p>").show(),i=!1),i},r.toggleLoading=function(e){var t=c("["+r.selectors.loadingIndicator+"]"),o=c("["+r.selectors.columnSelection+"]");if(e)return c(t).show(),void c(o).hide();c(t).hide(),c(o).show()},r.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).Import=function(){var o=this,l=jQuery;return o.pause=!1,o.offset=parseInt(wpsl_locator.importoffset),o.completecount=parseInt(wpsl_locator.complete_count),o.errorcount=parseInt(wpsl_locator.error_count),o.imports_per_request=5,o.selectors={startButton:"data-simple-locator-import-start-button",pauseButton:"data-simple-locator-import-pause",intro:"data-simple-locator-import-intro",lastImported:"data-simple-locator-import-last-imported",progressMessage:"data-simple-locator-import-progress-message",progressBar:"data-simple-locator-import-progress-bar",progressBarBackground:"data-simple-locator-import-progress-bar-background",error:"data-simple-locator-import-error",errorCount:"data-simple-locator-import-error-count",progressCount:"data-simple-locator-import-progress-count",importComplete:"data-simple-locator-import-complete",totalCount:"data-simple-locator-import-total-count"},o.bindEvents=function(){l(document).on("click","["+o.selectors.startButton+"]",function(e){e.preventDefault(),o.startImport()}),l(document).on("click","["+o.selectors.pauseButton+"]",function(e){e.preventDefault(),o.pause=!o.pause;var t=o.pause?wpsl_locator.pause_continue:wpsl_locator.pause;l(this).text(t),o.doImport()})},o.startImport=function(){l("["+o.selectors.intro+"],["+o.selectors.lastImported+"]").hide(),l("["+o.selectors.progressMessage+"]").show(),o.doImport()},o.doImport=function(){o.pause||l.ajax({url:ajaxurl,type:"post",datatype:"json",data:{action:"wpsldoimport",nonce:wpsl_locator.locatorNonce,offset:o.offset,imports_per_request:o.imports_per_request},success:function(e){if("complete"!==e.status)return"error"===e.status?(l("["+o.selectors.error+"]").html("<p>"+e.message+"</p>").show(),void l("["+o.selectors.progressMessage+"]").hide()):void o.updateProgress(e);o.completeImport()}})},o.updateProgress=function(e){o.completecount=o.completecount+e.import_count,o.offset=o.offset+e.import_count+e.failed_count,o.errorcount=o.errorcount+e.failed_count,l("["+o.selectors.progressCount+"]").text(o.completecount),l("["+o.selectors.errorCount+"]").text(o.errorcount);var t=l("["+o.selectors.progressBarBackground+"]").width()*(o.completecount/parseInt(l("["+o.selectors.progressBarBackground+"]").data("total")));l("["+o.selectors.progressBar+"]").width(t+"px"),o.doImport()},o.completeImport=function(){l("["+o.selectors.progressMessage+"]").hide(),l("["+o.selectors.importComplete+"]").show(),l.ajax({url:ajaxurl,type:"post",datatype:"json",data:{action:"wpslfinishimport"},success:function(e){l("["+o.selectors.totalCount+"]").text(e.import_count),l("["+o.selectors.errorCount+"]").text(e.error_count),0<e.errors.length&&o.appendErrorRows(e.errors)}})},o.appendErrorRows=function(e){for(var t=0;t<e.length;t++){var o="<tr><td>"+e[t].row+"</td><td>"+e[t].error+"</td></tr>";l(".wpsl-import-details table").append(o)}l(".wpsl-import-details").show()},o.bindEvents()},(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).ListingMap=function(){var m=this,g=jQuery;return m.listings=[],m.markers=[],m.selectors={mapLink:"data-wpsl-listing-map-link",listingLatitude:"data-wpsl-post-latitude",listingLongitude:"data-wpsl-post-longitude",listingId:"data-wpsl-listing-post-id",listingTitle:"data-wpsl-post-title",listingEditLink:"data-wpsl-edit-link",listingViewLink:"data-wpsl-view-link",listingInfoWindow:"data-wpsl-post-infowindow"},m.bindEvents=function(){g(document).ready(function(){"1"===wpsl_locator.show_listing_map&&"1"===wpsl_locator.edit_listing&&(g(".wp-list-table").length<1||(m.addMapElement(),m.setListings()))}),g(document).on("click","["+m.selectors.mapLink+"]",function(e){e.preventDefault(),m.openInfoWindow(g(this))})},m.addMapElement=function(){g('<div class="wpsl-post-listing-map" id="wpsl-post-listing-map"></div>').insertBefore(".wp-list-table")},m.setListings=function(){var e=g(".wp-list-table tbody tr");g.each(e,function(e,t){var o=g(this).find("["+m.selectors.mapLink+"]");g(o).attr(m.selectors.mapLink,e);var l={id:g(o).attr(m.selectors.listingId),title:g(o).attr(m.selectors.listingTitle),editLink:g(o).attr(m.selectors.listingEditLink),viewLink:g(o).attr(m.selectors.listingViewLink),latitude:g(o).attr(m.selectors.listingLatitude),longitude:g(o).attr(m.selectors.listingLongitude)},s=g(o).siblings("["+m.selectors.listingInfoWindow+"]").html();s+="<p>",s+='<a href="'+l.editLink+'" class="button">'+wpsl_locator.edit+"</a>",s+="</p>",l.infowindow=s,m.listings.push(l)}),m.loadMap()},m.loadMap=function(){var e,t=wpsl_locator.mapstyles,o=wpsl_locator.mappin?wpsl_locator.mappin:"",l=new google.maps.LatLngBounds,s=m.listings,a=g("#wpsl-post-listing-map"),n={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:t,scrollwheel:!1,panControl:!1},i=new google.maps.InfoWindow,r=new google.maps.Map(a[0],n);for(e=0;e<s.length;e++){var c=new google.maps.LatLng(s[e].latitude,s[e].longitude);l.extend(c);var p=new google.maps.Marker({position:c,map:r,title:s[e].title,icon:o});m.markers.push(p),google.maps.event.addListener(p,"click",function(e,t){return function(){i.setContent(s[t].infowindow),i.open(r,e)}}(p,e)),r.fitBounds(l);var d=google.maps.event.addListener(r,"idle",function(){s.length<2&&r.setZoom(13),google.maps.event.removeListener(d)})}var u=google.maps.event.addListener(r,"bounds_changed",function(e){google.maps.event.removeListener(u)})},m.openInfoWindow=function(e){var t=g(e).attr(m.selectors.mapLink);google.maps.event.trigger(m.markers[t],"click")},m.bindEvents()},jQuery(document).ready(function(){new SimpleLocatorAdmin.Factory}),(SimpleLocatorAdmin=SimpleLocatorAdmin||{}).endpoints={};var editScreenGoogleApiError=!(SimpleLocatorAdmin.Factory=function(){jQuery;return this.init=function(){new SimpleLocatorAdmin.Modals,new SimpleLocatorAdmin.PostEdit,new SimpleLocatorAdmin.GeneralSettings,new SimpleLocatorAdmin.PostType,new SimpleLocatorAdmin.MapDisplay,new SimpleLocatorAdmin.ResultsDisplay,new SimpleLocatorAdmin.DefaultMap,new SimpleLocatorAdmin.SearchHistory,new SimpleLocatorAdmin.ImportUpload,new SimpleLocatorAdmin.ImportColumnMap,new SimpleLocatorAdmin.Import,new SimpleLocatorAdmin.ListingMap},this.init()});function gm_authFailure(e){editScreenGoogleApiError=!0}